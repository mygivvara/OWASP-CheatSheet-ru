# Шпаргалка по раскрытию уязвимостей

## Вступление

Эта шпаргалка предназначена для того, чтобы дать рекомендации по процессу раскрытия уязвимостей как исследователям в области безопасности, так и организациям. Это область, где сотрудничество чрезвычайно важно, но часто может привести к конфликту между двумя сторонами.

**[Исследователи] (#отчетность-уязвимости) должны:**

- Убедиться, что любое тестирование является законным и санкционированным.
- Уважать конфиденциальность других лиц.
- Прилагать разумные усилия, чтобы связаться со службой безопасности организации.
- Предоставлять достаточно подробнуб информацию, чтобы можно было проверить и воспроизвести уязвимости.
- Не требовать оплаты или вознаграждения за сообщение об уязвимостях за пределами установленной программы вознаграждения за ошибки.

**[Организации] (#получающие отчеты об уязвимостях) должны:**

- Предоставлять исследователям четкий метод безопасного сообщения об уязвимостях.
- Четко определять сферу охвата и условия любых программ по поиску ошибок.
- Отвечайть на сообщения в разумные сроки.
- Открыто общайться с исследователями.
- Не угрожать исследователям судебными исками.
- Запрашивать, где это уместно, доказательства.
- Публиковать четкие рекомендации по безопасности и списки изменений.
- Предлагать вознаграждения и кредиты.

## Методы раскрытия информации

Существует ряд различных моделей, которым можно следовать при выявлении уязвимостей, которые перечислены в разделах ниже.

### Раскрытие частной информации

В модели частного раскрытия информации информация об уязвимости передается организации в частном порядке. Организация может принять решение опубликовать подробную информацию об уязвимостях, но это делается по усмотрению организации, а не исследователя, что означает, что многие уязвимости могут никогда не стать достоянием общественности. Большинство программ поиска ошибок требуют, чтобы исследователь следовал этой модели.

Основная проблема этой модели заключается в том, что если поставщик не отвечает на запросы или решает не устранять уязвимость, то подробности могут никогда не стать достоянием общественности. Исторически сложилось так, что исследователям надоело, что компании игнорируют уязвимости и пытаются их скрыть, что привело их к полному раскрытию информации.

### Полное раскрытие информации

При использовании метода полного раскрытия информации все сведения об уязвимости становятся достоянием общественности сразу же после ее обнаружения. Это означает, что злоумышленники получают полную информацию (иногда включая код эксплойта), часто до того, как будет выпущен патч. Подход полного раскрытия информации в основном используется в ответ на сообщения организаций об уязвимостях, игнорирующих их, с целью оказания на них давления с целью разработки и публикации исправления.

Это делает подход к полному раскрытию информации весьма противоречивым, и многие люди считают его безответственным. Как правило, его следует рассматривать только в качестве последнего средства, когда все другие методы не работают или когда код эксплойта уже общедоступен.

### Ответственное или скоординированное раскрытие информации

Ответственное раскрытие информации пытается найти разумную золотую середину между этими двумя подходами. При ответственном раскрытии информации первоначальный отчет составляется в частном порядке, но полная информация публикуется после того, как патч становится доступным (иногда с задержкой, чтобы дать больше времени для установки исправлений).

Во многих случаях исследователь также устанавливает крайний срок, в течение которого организация должна отреагировать на отчет или предоставить исправление. Если этот крайний срок не соблюдается, исследователь может применить подход полного раскрытия и опубликовать полную информацию.

В Google [Project Zero](https://googleprojectzero.blogspot.com/2020/01/policy-and-disclosure-2020-edition.html) используется аналогичный подход, при котором полная информация об уязвимости публикуется через 90 дней независимо от того, опубликовала ли организация исправление или нет.

## Сообщение об уязвимостях

Этот раздел предназначен для того, чтобы дать исследователям безопасности рекомендации о том, как сообщать организациям об уязвимостях.

### Предупреждения и законность

Прежде чем проводить какие-либо исследования в области безопасности или сообщать об уязвимостях, **убедитесь, что вы знаете и понимаете законы вашей юрисдикции**. Данная шпаргалка **не является юридической консультацией и не должна восприниматься как таковая.**.

Следующие пункты указывают на ряд областей, которые следует рассмотреть:

- Если вы проводите тестирование в рамках программы "Вознаграждение за ошибки" или аналогичной программы, организация, возможно, установила политику ["безопасная гавань"](https://disclose.io), которая позволяет вам проводить тестирование на законных основаниях, **при условии, что вы соблюдаете рамки и правила их программы**. Убедитесь, что вы внимательно прочитали содержание - выход за рамки содержания и правил может быть уголовно наказуемым деянием.
- В некоторых странах действуют законы, ограничивающие реверс-инжиниринг, поэтому тестирование с использованием локально установленного программного обеспечения может быть запрещено.
- Не требуйте оплаты или иного вознаграждения в качестве условия предоставления информации об уязвимостях в системе безопасности или в обмен на то, чтобы не публиковать детали или не сообщать о них отраслевым регулирующим органам, поскольку это может представлять собой вымогательство.
- Если вы получаете вознаграждение за ошибки, оно, как правило, рассматривается как доход, что означает, что оно может облагаться налогом. **Вы несете ответственность** за предоставление информации об этом доходе и обеспечение уплаты соответствующего налога с него.
- Если вы обнаружите уязвимости в своей работе или на оборудовании, принадлежащем вашему работодателю, ваш работодатель может помешать вам сообщить об этом или потребовать вознаграждение за исправление ошибок. Внимательно прочитайте свой контракт и подумайте о том, чтобы проконсультироваться с юристом, прежде чем делать это.

### Поиск контактных данных

Первым шагом в сообщении об уязвимости является поиск подходящего лица, которому можно сообщить об этом. Хотя некоторые организации опубликовали четкие правила раскрытия информации, многие этого не делают, поэтому может быть сложно найти подходящее место для сообщения о проблеме.

Если четкой политики раскрытия информации нет, контактные данные могут быть указаны в следующих разделах:

- Программы поиска ошибок, такие как [BugCrowd](https://bugcrowd.com/programs), [HackerOne](https://hackerone.com/directory/programs), [huntr.dev](https://huntr.dev/bounties), [Open Bug Bounty](https://www.openbugbounty.org) или [Standoff](https://bugbounty.standoff365.com).
- Файл [security.txt](https://security txt.org) на веб-сайте по адресу `/.well-known/security.txt` в соответствии с [RFC 9116](https://www.rfc-editor.org/rfc/rfc9116.html#name-location-of-the-securitytxt).
- Существующей системе отслеживания проблем.
- Общие адреса электронной почты, такие как `security@` или `abuse@`.
- Общая страница "Свяжитесь с нами" на веб-сайте.
- Платформы социальных сетей.
- Звонок в организацию.
- Обращение к сообществу.

При обращении к людям, которые не являются специальными контактными лицами по вопросам безопасности, запрашивайте информацию о соответствующем сотруднике, а не раскрывайте информацию об уязвимости любому, кто согласится на первоначальный контакт (особенно через социальные сети).

Если нет возможности связаться с организацией напрямую, возможно, вам поможет национальный или отраслевой [CERT](https://en.wikipedia.org/wiki/Computer_emergency_response_team).

### Первоначальный отчет

Как только контактное лицо, ответственное за безопасность, будет идентифицировано, следует составить первоначальный отчет о деталях уязвимости. В идеале это должно быть сделано по зашифрованному каналу (например, с использованием ключей PGP), хотя многие организации это не поддерживают.

Первоначальный отчет должен включать:

- Достаточно подробной информации об уязвимости, чтобы ее можно было понять и воспроизвести.
- HTTP-запросы и ответы, фрагменты HTML-кода, скриншоты или любые другие подтверждающие доказательства.
    - Отредактируйте все личные данные перед отправкой сообщения.
    - Некоторые организации могут попытаться заявить, что уязвимостей никогда не существовало, поэтому убедитесь, что у вас есть достаточные доказательства того, что они существовали.
- Подтверждающий концепцию код PoC (если таковой имеется).
- Влияние уязвимости.
- Любые ссылки или дополнительная информация, которые могут оказаться полезными.

Во многих случаях, особенно в небольших организациях, отчеты о безопасности могут составляться разработчиками или ИТ-персоналом, которые не имеют опыта работы в области безопасности. Это означает, что они могут быть не знакомы со многими концепциями или терминологией в области безопасности, поэтому отчеты должны быть составлены в понятных и простых выражениях.

Также может оказаться полезным дать рекомендацию о том, как можно было бы смягчить или решить проблему. Однако, если вам не известны детали системы или приложения или вы не очень уверены в рекомендации, возможно, будет лучше указать разработчикам на некоторые более общие рекомендации (например, на шпаргалку OWASP).

Если вы планируете опубликовать подробную информацию об уязвимости по истечении определенного периода времени (в соответствии с некоторыми политиками [ответственного раскрытия информации] (#ответственное-или-скоординированное-раскрытие информации)), то об этом следует четко сообщить в первоначальном электронном письме, но постарайтесь сделать это таким тоном, чтобы это не звучало как угроза для получателя.

Если в организации нет установленной программы вознаграждения за ошибки, не задавайте вопросов о выплатах или вознаграждении при первоначальном контакте - оставьте это до тех пор, пока проблема не будет подтверждена (или, в идеале, устранена). В частности, **не требуйте оплаты до раскрытия деталей уязвимости**. В лучшем случае это будет выглядеть как попытка обмануть компанию, в худшем - как вымогательство.

### Постоянная коммуникация

В то время как более простые уязвимости могут быть устранены только на основе первоначального отчета, во многих случаях исследователь и организация обмениваются несколькими электронными письмами. В случае более сложных уязвимостей разработчики или администраторы могут запросить дополнительную информацию или рекомендации по устранению проблемы. Они также могут обратиться за помощью в тестировании проблемы после того, как исправление будет внедрено. Хотя нет никаких обязательств проводить повторное тестирование, если запрос обоснован, а предоставление отзывов об исправлениях очень полезно.

Также может возникнуть необходимость в проверке организации, если она перестанет отвечать на запросы или если приближается установленный срок для публичного раскрытия уязвимости. Убедитесь, что это сообщение является профессиональным и позитивным - если процесс раскрытия станет враждебным, ни одна из сторон не выиграет.

Наберитесь терпения, если решение проблемы займет некоторое время. Разработчики могут испытывать значительное давление со стороны разных сотрудников организации и не могут быть полностью открыты в общении. Сортировка, разработка, проверка, тестирование и развертывание исправлений в корпоративной среде занимает **значительно** больше времени, чем ожидает большинство исследователей, а постоянные запросы на обновления только увеличивают нагрузку на разработчиков.

### Когда нужно сдаваться

Несмотря на все ваши усилия, некоторые организации не заинтересованы в обеспечении безопасности, с ними невозможно связаться или они могут проявлять активную враждебность к исследователям, раскрывающим уязвимости. В некоторых случаях они могут даже угрожать подать в суд на исследователей. Когда такое случается, это очень огорчает исследователя - важно не принимать это близко к сердцу. Когда это происходит, есть несколько вариантов, которые можно предпринять.

- Публично раскрывать уязвимость и иметь дело с любой негативной реакцией и, возможно, даже с судебным иском. Неважно, есть ли у них веские юридические аргументы - у них дорогие юристы, а борьба с любыми судебными исками является дорогостоящей и отнимает много времени. Прежде чем пойти по этому пути, спросите себя, _действительно ли оно того стоит?_
- Анонимно сообщать об уязвимости. Однако, если вы уже связывались с организацией и пытались сообщить ей об уязвимости, может быть совершенно очевидно, кто несет ответственность за раскрытие информации. Если вы собираетесь использовать этот подход, убедитесь, что вы приняли достаточные оперативные меры безопасности для собственной защиты.
- Сообщите об уязвимости третьей стороне, например, отраслевому регулирующему органу или органу по защите данных.
- Живите дальше.

Есть много организаций, которые искренне заинтересованы в безопасности и очень открыты для сотрудничества с исследователями в области безопасности. Если уязвимость не является чрезвычайно серьезной, **не стоит изводить себя или рисковать своей карьерой и средствами к существованию из-за организации, которой все равно**.

### Публикация

После того, как уязвимость будет исправлена (или нет), необходимо принять решение о публикации подробной информации. В идеале это должно быть сделано путем обсуждения с поставщиком, и, как минимум, поставщик должен быть уведомлен о том, что вы намерены опубликовать, и предоставить ссылку на опубликованную информацию. Раскрытие информации, как правило, включает:

- Подробное описание уязвимости и ее последствий.
- Подробную информацию о том, какие версии уязвимы, а какие исправлены.
- Технические подробности или потенциально подтверждающий концепцию код PoC.
- Способы устранения или обходные пути.
- Ссылки на опубликованные рекомендации поставщика.
- График обнаружения, взаимодействия с поставщиками и выпуска.

Некоторые организации могут потребовать, чтобы вы вообще не публиковали подробную информацию или отложили публикацию, чтобы предоставить своим пользователям больше времени для установки исправлений безопасности. В интересах поддержания позитивных отношений с организацией стоит попытаться найти компромиссную позицию по этому вопросу.

Вопрос о том, публиковать ли рабочее подтверждение концепции (или функциональный код эксплойта), является предметом обсуждения. Некоторые люди сочтут это неэтичным шагом и будут утверждать, что, поступая так, вы напрямую помогаете преступникам компрометировать их пользователей. С другой стороны, этот код может быть использован как системными администраторами, так и специалистами по тестированию на проникновение для тестирования своих систем, и злоумышленники смогут разработать или перепроектировать рабочий код эксплойта, если уязвимость окажется достаточно ценной.

Если вы публикуете информацию в неблагоприятных условиях (например, когда организация не отвечает на запросы или по истечении установленного периода времени), вы можете столкнуться с угрозами и даже судебным иском. Наличие каких-либо правовых оснований для этого будет зависеть от вашей юрисдикции и от того, подписали ли вы с организацией соглашение о неразглашении в какой-либо форме. Прежде чем делать это, убедитесь, что вы понимаете свою правовую позицию.

Обратите внимание, что многие программы вознаграждения за ошибки запрещают исследователям публиковать подробности без согласия организации. Если вы решите сделать это, вы можете лишиться вознаграждения или быть заблокированы на платформе - поэтому ознакомьтесь с правилами программы перед публикацией.

## Получение отчетов об уязвимостях

Этот раздел предназначен для того, чтобы дать организациям рекомендации о том, как принимать и получать отчеты об уязвимостях.

### Программы поощрения за обнаружение уязвимостей (Bug Bounty) 

Программы поощрения за обнаружение уязвимостей (Bug Bounty) стимулируют исследователей выявлять уязвимости и сообщать о них организациям, предлагая вознаграждение. Обычно это денежные средства, но также могут быть физические предметы (swag). Этот процесс часто управляется третьей стороной, такой как [BugCrowd](https://bugcrowd.com/programs) или [HackerOne](https://hackerone.com/directory/programs), которые обеспечивают посредничество между исследователями и организациями.

При реализации программы вознаграждения за ошибки необходимо четко определить следующие области:

- Какие системы и приложения входят в сферу применения.
    - Живые системы или промежуточная/UAT среда?
    - За исключением систем, управляемых третьими лицами или принадлежащих им.
- За какие типы уязвимостей можно получить вознаграждение (проблемы с SSL/TLS? Отсутствие заголовков безопасности HTTP? Раскрытие версии?)
- Правовые положения, такие как политика безопасной гавани.
    - В проекте [disclose.io](https://disclose.io) представлены некоторые примеры политик.
    - Воспользуйтесь юридической консультацией юристов, **а не этой шпаргалкой**.
- Сколько предложить за вознаграждение и как принимается решение.
    - Программа может стать очень дорогостоящей, если будет обнаружено большое количество уязвимостей.
    - Слишком мало, и исследователи могут не утруждать себя работой с программой.
- График первоначального ответа, подтверждения, выплаты и разрешения проблемы.

#### Когда следует внедрять программу Bug Bounty

Программы Bug bounty были внедрены многими крупными организациями, такими как Microsoft, и начинают использоваться за пределами коммерческого сектора, включая Министерство обороны США. Однако для небольших организаций они могут создавать серьезные проблемы и требовать значительных затрат времени и ресурсов. Эти проблемы могут включать:

- Наличие достаточного количества времени и ресурсов для реагирования на сообщения.
- Наличие достаточно квалифицированного персонала для эффективной сортировки сообщений.
    - Отчеты могут содержать большое количество нежелательных сообщений или ложных срабатываний.
    - Управляемые программы поиска ошибок могут помочь, выполнив первоначальную сортировку (за определенную плату).
- Работа с большим количеством ложных срабатываний и нежелательных сообщений.
- Влияние людей, тестирующих живые системы (в том числе неквалифицированных злоумышленников, использующих автоматизированные инструменты, в которых они не разбираются).
- Неспособность отличить законный трафик для тестирования от вредоносных атак.
- Исследователи выходят за рамки и тестируют системы, которые им не следует тестировать.
- Финансовые затраты на запуск программы (некоторые компании выплачивают сотни тысяч долларов в год в виде вознаграждений).
- Работа с исследователями, которые недовольны тем, как работает программа (например, оспаривают размер вознаграждения или злятся, когда обнаруживают, что проблемы дублируются или выходят за рамки области применения).

Несмотря на эти потенциальные проблемы, программы поиска уязвимостей являются отличным способом выявления уязвимостей в приложениях и системах. Однако их следует использовать только тем организациям, у которых уже есть отработанный процесс раскрытия уязвимостей, поддерживаемый надежными внутренними процессами устранения уязвимостей.

### Контактные данные для публикации

Самый важный шаг в этом процессе - предоставить исследователям безопасности возможность связаться с вашей организацией. Чем проще для них это сделать, тем больше вероятность того, что вы получите отчеты о безопасности. Следующий список включает в себя некоторые из распространенных механизмов, которые используются для этого - чем больше из них вы сможете реализовать, тем лучше:

- Специальный контакт по вопросам безопасности на странице "Связаться с нами".
- Специальные инструкции по сообщению о проблемах безопасности в системе отслеживания ошибок.
- Общий адрес электронной почты `security@`.
- Файл [security.txt](https://security txt.org) на веб-сайте по адресу `/.well-known/security.txt` в соответствии с [RFC 9116](https://www.rfc-editor.org/rfc/rfc9116.html#name-location-of-the-securitytxt).
- Используя стороннюю программу [bug bounty] (#программы-bug-bounty).

Также важно обеспечить, чтобы сотрудники на переднем крае (например, те, кто следит за основным контактным адресом, веб-чатом и телефонными линиями) были осведомлены о том, как обрабатывать сообщения о проблемах безопасности и кому следует передавать эти сообщения внутри организации.

#### Предоставление руководящих принципов отчетности

Помимо контактных данных, полезно также предоставить некоторые рекомендации, которым исследователи должны следовать при сообщении об уязвимостях. Они могут включать:

- Запрос конкретной информации, которая может помочь в подтверждении и устранении проблемы.
- Использование определенных категорий или пометка проблемы как конфиденциальной в системе отслеживания ошибок.
- Предоставление ключей PGP для зашифрованной связи.
- Установление сроков для первоначального реагирования и сортировки.
- Создание условий для обеспечения безопасности.

### Общение с Исследователями

Коммуникация между исследователями и организациями часто является одним из самых сложных моментов в процессе раскрытия уязвимостей и может легко привести к разочарованию обеих сторон.

В приведенной ниже схеме представлен пример идеального процесса коммуникации:

- Ответьте на первоначальный запрос о предоставлении контактных данных, указав исследователю четкий механизм предоставления дополнительной информации.
- Подтвердите информацию об уязвимости и укажите сроки для проведения сортировки.
- При необходимости запросите дополнительные разъяснения или детали.
- Подтвердите уязвимость и укажите сроки для внедрения исправления.
    - Подтвердите детали любого предлагаемого вознаграждения.
- При необходимости попросите исследователя повторно протестировать уязвимость.
- Подтвердите, что уязвимость устранена.

На протяжении всего процесса регулярно сообщайте о текущем статусе и предполагаемых сроках устранения уязвимости. Даже если для этого нет четких сроков, постоянное общение дает некоторую уверенность в том, что об уязвимости не забыли.

#### Исследователи, требующие оплаты

Некоторые люди могут обратиться в организацию, заявив, что обнаружили уязвимость, и потребовать оплату, прежде чем предоставить информацию. Хотя эти запросы могут быть законными, во многих случаях они являются просто мошенничеством.

Один из вариантов заключается в том, чтобы запросить раскрытие информации через платформу, которая может обеспечить определенный уровень защиты для обеих сторон, поскольку мошенники вряд ли захотят использовать эти платформы.

### Разглашение

#### Коммерческие и программные обеспечения с открытым исходным кодом

Как только уязвимость будет устранена (и проведена повторная проверка), подробности должны быть опубликованы в руководстве по безопасности программного обеспечения. Важно помнить, что публикация сведений о проблемах безопасности **не выставляет поставщика в невыгодном свете**. Все программное обеспечение имеет уязвимости в системе безопасности, и демонстрация четкого и отлаженного процесса их устранения и раскрытия дает гораздо больше уверенности в безопасности программного обеспечения, чем попытки скрыть проблемы.

Как минимум, рекомендации по безопасности должны содержать:

- Подробное описание уязвимости, включая последствия.
- Подробный список уязвимых версий.
- Подробный список версий исправлений.
- Любые указания на то, когда программное обеспечение уязвимо (например, если затронуты только определенные конфигурации).
- Любые обходные пути или меры по смягчению последствий, которые могут быть реализованы в качестве временного решения.
- [CVE](https://cve.mitre.org/cve/request_id.html) для обозначения уязвимости.

Там, где это возможно, также полезно включить:

- График процесса раскрытия уязвимости.
- Благодарность исследователю, который выявил уязвимость.
- Технические подробности уязвимости.
- Подписи IDS/IPS или другие индикаторы компрометации.

Security advisories should be easy for developers and system administrators to find. Common ways to publish them include:

- Специальная страница "Безопасность" или "рекомендации по безопасности" на веб-сайте.
- Список рассылки или форум по безопасности.
- Ссылки на основные журналы изменений и примечания к выпуску.

Некоторые исследователи могут публиковать свои собственные технические описания уязвимости, которые обычно содержат полную информацию, необходимую для ее использования (а иногда даже рабочий код эксплойта). В случае более серьезных уязвимостей, возможно, имеет смысл попросить исследователя отложить публикацию полной информации на некоторое время (например, на неделю), чтобы дать системным администраторам больше времени для установки исправлений до того, как будет доступен код эксплойта. Однако, как только патч будет выпущен, злоумышленники смогут перепроектировать уязвимость и разработать свой собственный код эксплойта, поэтому отсрочка полного выпуска имеет ограниченный смысл.

#### Частные системы

В случае уязвимостей в частных системах необходимо принять решение о том, следует ли публиковать подробную информацию после устранения уязвимости. Большинство программ вознаграждения за устранение ошибок предоставляют организациям возможность решать, следует ли раскрывать подробную информацию после устранения проблемы, хотя обычно это не требуется.

Публикация этих сведений помогает продемонстрировать, что организация применяет активный и прозрачный подход к обеспечению безопасности, но также может привести к тому, что потенциально досадные упущения и неправильные настройки станут достоянием общественности. В случае будущего взлома или утечки данных они также могут быть использованы в качестве доказательства слабой культуры безопасности в организации. Кроме того, они могут раскрывать технические детали внутренней безопасности и могут помочь злоумышленникам выявить другие аналогичные проблемы. Таким образом, это решение должно быть тщательно оценено, и, возможно, было бы разумно обратиться за юридической консультацией.

### Награждение исследователей

В тех случаях, когда исследователи выявляли уязвимости и сообщали о них вне рамок программы поощрения за ошибки (по сути, предоставляя бесплатное тестирование безопасности) и действовали профессионально и услужливо на протяжении всего процесса раскрытия уязвимостей, полезно предложить им какое-либо вознаграждение, чтобы стимулировать такое позитивное взаимодействие в будущем. Если денежное вознаграждение невозможно, то следует рассмотреть ряд других вариантов, таких как:

- Скидки или кредиты на услуги или продукты, предлагаемые организацией.
- Виртуальные награды (например, специальные внутриигровые предметы, пользовательские аватары и т.д.).
- Футболки, наклейки и другие фирменные предметы (swag).
- Включение в "зал славы" или другое подобное признание.

## Дополнительная литература

- [The CERT Guide to Coordinated Vulnerability Disclosure](https://vuls.cert.org/confluence/display/CVD/The+CERT+Guide+to+Coordinated+Vulnerability+Disclosure)
- [HackerOne's Vulnerability Disclosure Guidelines](https://www.hackerone.com/disclosure-guidelines)
- [Disclose.io's Vulnerability Disclosure Terms](https://github.com/disclose/disclose/tree/master/terms)
