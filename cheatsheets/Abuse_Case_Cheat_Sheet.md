# Шпаргалка по злоупотреблению

## Введение

Часто, при указании уровня безопасности приложения, в требованиях можно встретить следующие пункты:

- *Приложение должно быть безопасным*.
- *Приложение должно быть защищено от всех атак, нацеленных на эту категорию приложений*.
- *Приложение должно быть защищено от атак из списка OWASP TOP 10*.
- ...

Эти требования слишком общие, и, следовательно, бесполезны для команды разработки.

Чтобы создать безопасное приложение с практической точки зрения, важно идентфицировать атаки, от которых приложение должно защищаться, в зависимости от его бизнес- и технического контекста.

### Цель

Цель этой шпаргалки - предоставить объяснение того, что такое **Злоупотребление**, почему злоупотребления важны при рассмотрении безопасности приложения, и, наконец, предложить прагматический подход к созданию списка злоупотреблений и отслеживанию их для каждой функции, планируемой для реализации в приложении. Данную шпаргалку можно использовать для этой цели независимо от используемой методики проекта (водопад или гибкая).

**Важное примечание:**

```text
Основная цель этой шпаргалки - предоставить прагматический подход, чтобы позволить компании или команде проекта начать создавать и обрабатывать список злоупотреблений, а затем адаптировать предложенные элементы к своему контексту/культуре с целью создания собственной методики.

Эту шпаргалку можно рассматривать как руководство по началу работы.
```

### Контекст и подход

#### Почему важно чётко идентифицировать атаки

Чёткая идентификация атак, отк которых приложение должно защищаться, является важной составляющей для выполнения следующих шагов в проекте или спринте:

- Оценить бизнес-риски для каждой из идентифицированных атак, чтобы выполнить отбор в зависимости от бизнес-риска и бюджета проекта/спринта.
- Вывести требования безопасности и добавить их в спецификацию проекта или пользовательские истории и критерии приёмки спринта.
- Оценить дополнительные затраты на первоначальном этапе проекта/спринта, которые будут необходимы для реализации контрмер.
- Что касается контрмер: позволить команде проекта определить их и установить, в каком месте они должны быть расположены (сеть, инфраструктура, код и т.д.).

#### Понятие злоупотребления

Чтобы помочь в создании списк атак, полезна концепция **Злоупотреблений**.

**Злоупотребление** можно определить как:

```text
Способ использования функции, который не был ожидаем разработчиком, что позволяет злоумышленнику влиять на функциональность или результат использования функции на основе действий (или ввода) злоумышленника.
```

Synopsys определяют **Злоупотребление** следующим образом:

```text
Злоупотребления и случаи неправильного использования описывают, как пользователи злоупотребляют
или эксплуатируют слабости в контролях программных функций для атаки на приложение.

Это может привести к реальному бизнес-импакту, когда напрямую атакуются бизнес-функциональности, что может привести к потерям или негативному пользовательскому опыту.

Случаи злоупотребления также могут быть эффективным способом формирования требований безопасности, которые приведут к надлежащей защите этих критически важных бизнес-кейсов.
```

[Источник Synopsys](https://www.synopsys.com/blogs/software-security/abuse-cases-can-drive-security-requirements.html)

#### Как определить список злоупотреблений

Существует много различных способов определить список злоупотреблений для функции (которая может быть сопоставлена с пользовательской историей в Agile-проектах)

Проект [OWASP Open SAMM](https://owasp.org/www-project-samm/) предлагает следующий подход в *Потоке B* к практикам безопасности *тестирования основанного на требованиях* для уровня зрелости 2:

```text
Случаи неправильного использования и злоупотребления описывают непреднамеренные и злонамеренные сценарии использования приложения, описывая, как злоумышленник может это сделать. Создайте случаи неправильного использования и злоупотребления для использования или эксплуатации слабостей в контролях функций программного обеспечения для атаки на приложение. Используйте модели злоупотреблений для приложения, чтобы служить источником для идентификации конкретных тестов безопасности, которые напрямую или косвенно эксплуатируют сценарии злоупотреблений.

Злоупотребление функциональностью, иногда называемое «атакой бизнес-логики», зависит от дизайна и реализации функций и особенностей приложения. Примером является использование процесса сброса пароля для перечисления учетных записей. В рамках тестирования бизнес-логики определите важные бизнес-правила для приложения и превратите их в эксперименты для проверки того, правильно ли приложение применяет бизнес-правило. Например, в приложении для торговли акциями, разрешено ли злоумышленнику начать сделку в начале дня и зафиксировать цену, держать транзакцию открытой до конца дня, а затем завершить продажу, если цена акции возросла, или отменить, если цена упала?
```

Источник Open SAMM: [Verification Requirements Driven Testing Stream B](https://owaspsamm.org/model/verification/requirements-driven-testing/stream-b/)

Еще один способ создания списка может быть следующим (более ориентированным на подход «снизу вверх» и сотрудничество):

Проведите воркшоп с участием людей со следующими профилями:

- **Бизнес-аналитики**: Ключевые сотрудники, которые будут описывать каждую функцию с точки зрения бизнеса.
- **Аналитики по рискам**: Сотрудники компании, которые будут оценивать бизнес-риски предлагаемой атаки (иногда это роль выполняет бизнес-аналитик, в зависимости от компании).
- **Тестировщики на проникновение (пентестеры)**: "Атакующие", которые будут предлагать атаки, которые можно осуществить на рассматриваемые бизнес-функции. Если в компании нет сотрудника с таким профилем, можно запросить услуги внешних специалистов. При возможности включите двух пентестеров с разным опытом, чтобы увеличить количество потенциальных атак, которые будут выявлены и учтены.
- **Технические лидеры проектов**: Технические специалисты проекта, которые обеспечат технический обмен мнениями по поводу атак и контрмер, выявленных в ходе воркшопа
- **Аналитики по обеспечению качества или функциональный тестировщик**: Сотрудники, которые могут иметь хорошее представление о том, как приложение или функция должны работать (позитивное тестирование), как они не должны работать (негативное тестирование), и что вызывает их сбои (случаи отказов).

Во время воркшопа (продолжительность зависит от объема списка функций, но 4 часа — хорошее начало) будут обработаны все бизнес-функции, которые будут включены в проект или спринт. Результатом воркшопа будет список атак (случаев злоупотребления) для всех бизнес-функций. Каждому случаю злоупотребления будет присвоен уровень риска, который позволит фильтровать и расставлять приоритеты.

Важно учитывать как **технические**, так и **бизнесовые** случаи злоупотребления и соответственно их помечать.

*Пример:*

- Технический случай злоупотребления: Добавление Cross-Site-Scripting (XSS) инъекции в поле ввода комментария..
- Бизнесовый случай злоупотребления: Возможность произвольного изменения цены товара в интернет-магазине перед оформлением заказа, что приводит к тому, что пользователь платит меньшую сумму за желаемый товар.

#### Когда определять списокк случаев злоупотребления

В проектах, реализуемых по методологии Agile, воркшоп по определению должен проводиться после собрания, на котором пользовательские истории (User Stories) включаются в спринт.

В проектах, реализуемых по каскадной модели (Waterfall), воркшоп по определению должен проводиться, когда бизнес-функции, которые будут реализованы, уже определены и известны бизнесу.

Независимо от используемого подхода к проекту (Agile или Waterfall), случаи злоупотребления, которые выбраны для рассмотрения, должны стать требованиями безопасности в каждом разделе спецификации функции (Waterfall) или критериями приемки пользовательской истории (Agile), чтобы позволить оценить дополнительные затраты/усилия, а также идентифицировать и внедрить контрмеры.

Каждому случаю злоупотребления должен быть присвоен уникальный идентификатор, чтобы обеспечить его отслеживание на протяжении всего проекта/спринта (подробности по этому пункту будут приведены в разделе предложения).

Пример формата уникального идентификатора может быть **ABUSE_CASE_001**.

На следующем рисунке показан обзор последовательности различных шагов, задействованных в процессе (слева направо):

![Обзорная схема](../assets/Abuse_Case_Cheat_Sheet_Overview.png)

### Предложение

Предложение будет сосредоточено на результатах воркшопа, объясненных в предыдущем разделе.

#### Шаг 1: Подготовка к воркшопу

Во-первых, даже если это кажется очевидным, ключевые бизнес-сотрудники должны быть уверены, что они знают, понимают и могут объяснить бизнес-функции, которые будут обрабатываться во время воркшопа.

Во-вторых, создайте новый файл Microsoft Excel (вы также можете использовать Google Sheets или любое другое аналогичное программное обеспечение) со следующими листами (или вкладками):

- **ФУНКЦИИ (FEATURES)**
    - Будет содержать таблицу со списком бизнес-функций, запланированных для воркшопа.
- **СЛУЧАИ ЗЛОУПОТРЕБЛЕНИЯ (ABUSE CASES)**
    - Будет содержать таблицу со всеми случаями злоупотребления, выявленными в ходе воркшопа.
- **КОНТРМЕРЫ (COUNTERMEASURES)**
    - Будет содержать таблицу со списком возможных контрмер (краткое описание), придуманных для выявленных случаев злоупотребления.
    - Этот лист не обязателен, но может быть полезным (для каждого случая злоупотребления), если устранение проблемы легко реализуемо и может повлиять на рейтинг риска.
    - Контрмеры могут быть определены профилем AppSec (специалистом по безопасности приложений) в ходе воркшопа, потому что сотрудник AppSec должен уметь не только совершать атаки, но и строить или определять меры защиты (это не всегда характерно для профиля пентестера, поскольку его основное внимание сосредоточено на атакующей стороне, поэтому комбинация пентестер + AppSec очень эффективна для получения всестороннего обзора).

Ниже представлено изображение каждого листа вместе с примером содержания, которое будет заполняться во время воркшопа:

Лист *ФУНКЦИИ*:

| Идентификатор функции |      Имя функции      |                    Краткое описание функции                   |
|:---------------------:|:---------------------:|:-------------------------------------------------------------:|
| FEATURE_001           | DocumentUploadFeature | Позволяет пользователю загрузить документ вместе с сообщением |

Лист *КОНТРМЕРЫ*:

| Идентификатор контрмеры  | Краткое описание контрмеры                             | Подсказка к контрмере                                       |
|--------------------------|--------------------------------------------------------|-------------------------------------------------------------|
| DEFENSE_001              | Валидируйте загруженный файл загрузив его в парсер     | Используйте советы из OWASP Cheat Sheet про загрузку файлов |

Лист *СЛУЧАИ ЗЛОУПОТРЕБЛЕНИЯ*:

| Идентификатор случая злоупотребления | Идентификатор функции, на которую оказано воздействие |                     Описание атаки злоупотреблением                     | Идентификатор атаки (если применимо) | Оценка по CVSS V3 |                CVSS V3 string                | Вид злоупотребления | Применимая контрмера | Решение о действии (устранить или принять риск) |
|:--------------------:|:-------------------:|:-----------------------------------------------------------------------:|:-------------------------------------:|:---------------------------:|:--------------------------------------------:|:------------------:|:----------------------------:|:-----------------------------------------------:|
| ABUSE_CASE_001       | FEATURE_001         | Загрузка файла Office с вредоносным макросом, который загружает вредоносное ПО | CAPEC-17                              | HIGH (7.7)                  | CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:C/C:N/I:H/A:H | Technical          | DEFENSE_001                  | Устранить                                      |

#### Шаг 2: Во время воркшопа

Используйте электронную таблицу для обзора всех функций.

Для каждой функции следуйте следующему алгоритму:

1. Ключевые бизнес-сотрудники объясняют текущую функцию с точки зрения бизнеса.
2. Пентестеры предлагают и объясняют набор атак, которые они могут выполнить против данной функции.
3. Для каждой предложенной атаки:
    1. Специалисты по безопасности приложений (AppSec) предлагают контрмеру и предпочтительное место ее реализации (инфраструктура, сеть, код, дизайн и т.д.).
    2. Технические специалисты дают отзыв о возможности реализации предложенной контрмеры.
    3. Пентестеры используют калькулятор CVSS v3 (или другой стандарт) для определения уровня риска. (например: [CVSS V3 калькулятор](https://www.first.org/cvss/calculator/3.0))
    4. Лидеры по управлению рисками должны принять или изменить рейтинг риска, чтобы определить окончательный балл риска, который точно отражает реальное влияние на бизнес компании.

4. Бизнес-лидеры, лидеры по управлению рисками и технические лидеры должны прийти к консенсусу и отфильтровать список злоупотреблений для текущей функции, оставив только те, которые необходимо устранить, и отметить их соответствующим образом в листе *СЛУЧАИ ЗЛОУПОТРЕБЛЕНИЯ* (**если риск принимается, добавьте комментарий, объясняющий причину**).
5. Перейти к следующей функции...

Если присутствие пентестеров невозможно, можно использовать следующие ресурсы для идентификации применимых атак на ваши функции:

- [Автоматизированные угрозы для веб-приложений OWASP](https://owasp.org/www-project-automated-threats-to-web-applications/)
- [Руководство по тестированию OWASP](https://owasp.org/www-project-web-security-testing-guide/stable/)
- [Руководство по тестированию мобильных приложений OWASP](https://github.com/OWASP/owasp-mstg)
- [Общая классификация и нумерация шаблонов атак (CAPEC)](https://capec.mitre.org/)

Important note on attacks and countermeasure knowledge base(s):

```text
Со временем и с опытом, накопленным в различных проектах, вы создадите собственный словарь атак и контрмер,
которые применимы к приложениям в вашей бизнес-области.

Этот словарь значительно ускорит проведение будущих воркшопов.

Для содействия созданию этого словаря, вы можете в конце проекта/спринта собрать список атак и контрмер 
в центральном месте (вики, база данных, файл...), который будет использоваться во время следующего воркшопа
в сочетании с данными от пентестеров.
```

#### Шаг 3: После воркшопа

На данном этапе в таблице содержится список всех случаев злоупотреблений, которые необходимо учесть, а также, возможно (в зависимости от возможностей), соответствующие контрмеры.

Теперь остаются две задачи:

1. Ключевые бизнес-специалисты должны обновить спецификацию каждой функции (Waterfall) или User Story каждой функции (Agile), чтобы включить связанные случаи злоупотреблений в качестве Требований к безопасности (Waterfall) или Критериев приемки (Agile).
2. Ключевые технические специалисты должны оценить затраты и усилия, необходимые для учета контрмер.

#### Шаг 4: В процессе реализации - Отслеживание обработки случаев злоупотреблений

Для отслеживания обработки всех случаев злоупотреблений можно использовать следующий подход:

Если один или несколько случаев злоупотреблений обрабатываются на уровне:

- **Проектирования, инфраструктуры или сети**
    - Сделайте пометку в документации или схеме, указывающую, что *Этот проект/сеть/инфраструктура учитывает случаи злоупотреблений ABUSE_CASE_001, ABUSE_CASE_002, ABUSE_CASE_xxx*.
- **Кода**
    - Разместите специальный комментарий в классах/скриптах/модулях, указывающий, что *Этот класс/модуль/скрипт учитывает случаи злоупотреблений ABUSE_CASE_001, ABUSE_CASE_002, ABUSE_CASE_xxx*.
    - Можно использовать специальную аннотацию, такую как `@AbuseCase(ids={"ABUSE_CASE_001","ABUSE_CASE_002"})`, чтобы облегчить отслеживание и идентификацию в интегрированной среде разработки.

Такой подход позволяет (с помощью небольшого скриптинга) определить, где именно обрабатываются случаи злоупотреблений.

#### Шаг 5: В процессе реализации - Проверка обработки случаев злоупотреблений

Поскольку случаи злоупотреблений определены, можно установить автоматизированные или ручные проверки для обеспечения того, чтобы:

- Все выбранные случаи злоупотреблений были обработаны.
- Случай злоупотребления был корректно/полностью обработан.

Проверки могут быть следующими:

- Автоматизированные (выполняемые регулярно при коммите, ежедневно или еженедельно в заданиях непрерывной интеграции проекта):
    - Пользовательские правила аудита в инструментах статического анализа безопасности приложений (SAST) или динамического анализа безопасности приложений (DAST).
    - Специальные модульные, интеграционные или функциональные тесты, ориентированные на безопасность.
    - ...
- Ручные:
    - Ревизия кода на безопасность между коллегами проекта в процессе проектирования или реализации.
    - Предоставление списка всех обработанных случаев злоупотреблений пентестерам, чтобы они могли оценить эффективность защиты для каждого случая злоупотребления во время тестирования на проникновение (пентестер проверит, что выявленные атаки больше неэффективны и попытается найти другие возможные атаки).
    - ...

Добавление автоматизированных тестов также позволяет командам отслеживать эффективность контрмер против случаев злоупотреблений и определять, сохранились ли контрмеры на месте во время фазы обслуживания или исправления ошибок проекта (чтобы предотвратить случайное удаление/отключение). Это также полезно при использовании подхода [Непрерывного развёртывания](https://continuousdelivery.com/) чтобы обеспечить наличие всех защит от случаев злоупотреблений перед открытием доступа к приложению.

### Пример вывода случаев злоупотреблений в User Stories

В следующем разделе представлен пример вывода случаев злоупотреблений в User Stories, используя в качестве исходного источника [OWASP TOP 10](https://owasp.org/www-project-top-ten/).

Персоны, ориентированные на угрозы:

- Злоумышленник
- Обычный пользователь, злоупотребляющий системой
- Неосведомленный пользователь

#### A1:2017-Injection

*Epic:*

Практически любой источник данных может быть вектором для внедрения, включая переменные окружения, параметры, внешние и внутренние веб-сервисы и всех типов пользователей. Уязвимости типа внедрение возникают, когда злоумышленник может отправить в интерпретатор враждебные данные.

*Злоупотребление:*

Как злоумышленник, я буду выполнять атаки внедрения (SQL, LDAP, XPath, или NoSQL запросы, команды ОС, XML парсеры, SMTP заголовки, языки выражений и ORM запросы) против полей ввода пользовательских или API интерфейсов.

#### A2:2017-Broken Authentication

*Epic:*

Злоумышленники имеют доступ к сотням миллионов действительных комбинаций имен пользователей и паролей для атак на основе подделки учетных данных, списков административных учетных записей по умолчанию, автоматизированных атак грубой силы и словарных атак. Атаки на управление сеансами хорошо известны, особенно в отношении неистекших токенов сеансов.

*Злоупотребление:*

Как злоумышленник, я имею доступ к сотням миллионов действительных комбинаций имен пользователей и паролей для атак на основе подделки учетных данных.

*Злоупотребление:*

Как злоумышленник, я имею списки административных учетных записей по умолчанию, инструменты для автоматизированных атак грубой силы и словарные атаки, которые использую против областей входа в приложение и систем поддержки.

*Злоупотребление:*

Как злоумышленник, я манипулирую токенами сеансов, используя истекшие и поддельные токены для получения доступа.

#### A3:2017-Sensitive Data Exposure

*Epic:*

Вместо того чтобы напрямую атаковать криптографию, злоумышленники крадут ключи, проводят атаки "человек посередине" или похищают данные в открытом виде с сервера, во время передачи или с клиента пользователя, например, браузера. Обычно требуется ручная атака. Ранее извлеченные базы данных паролей могут быть взломаны с помощью графических процессоров (GPU).

*Злоупотребление:*

Как злоумышленник, я краду ключи, которые были раскрыты в приложении, чтобы получить несанкционированный доступ к приложению или системе.

*Злоупотребление:*

Как злоумышленник, я провожу атаки "человек посередине", чтобы получить доступ к трафику и использовать его для получения конфиденциальных данных и возможно, чтобы получить несанкционированный доступ к приложению.

*Злоупотребление:*

Как злоумышленник, я краду данные в открытом виде с сервера, во время передачи или с клиента пользователя, например, браузера, чтобы получить несанкционированный доступ к приложению или системе.

*Злоупотребление:*

Как злоумышленник, я нахожу и нацеливаюсь на старые или слабые криптографические алгоритмы, захватывая трафик и взламывая шифрование.

#### A4:2017-XML External Entities (XXE)

*Epic:*

Злоумышленники могут эксплуатировать уязвимые XML-процессоры, если они могут загружать XML или включать враждебный контент в XML-документ, используя уязвимый код, зависимости или интеграции.

*Злоупотребление:*

Как злоумышленник, я использую уязвимые области приложения, где пользователь или система могут загружать XML, чтобы извлечь данные, выполнить удаленный запрос с сервера, сканировать внутренние системы, провести атаку на отказ в обслуживании, а также выполнить другие атаки.

*Злоупотребление:*

Как злоумышленник, я включаю враждебный контент в XML-документ, который загружается в приложение или систему, чтобы извлечь данные, выполнить удаленный запрос с сервера, сканировать внутренние системы, провести атаку на отказ в обслуживании, а также выполнить другие атаки.

*Злоупотребление:*

Как злоумышленник, я включаю вредоносный XML-код для эксплуатации уязвимого кода, зависимостей или интеграций, чтобы извлечь данные, выполнить удаленный запрос с сервера, сканировать внутренние системы, провести атаку на отказ в обслуживании (например, атаку "Billion Laughs"), а также выполнить другие атаки.

#### A5:2017-Broken Access Control

*Epic:*

Эксплуатация управления доступом является ключевым навыком злоумышленников. Управление доступом можно обнаружить с помощью ручных методов или, возможно, через автоматизацию для выявления отсутствия управления доступом в некоторых фреймворках.

*Злоупотребление:*

Как злоумышленник, я обхожу проверки управления доступом, изменяя URL, внутреннее состояние приложения или HTML-страницу, или просто используя инструмент атаки на API.

*Злоупотребление:*

Как злоумышленник, я манипулирую первичным ключом и изменяю его, чтобы получить доступ к записям других пользователей, позволяя просматривать или редактировать учетную запись другого человека.

*Злоупотребление:*

Как злоумышленник, я манипулирую сеансами, токенами доступа или другими средствами управления доступом в приложении, чтобы действовать как пользователь без входа в систему или как администратор/привилегированный пользователь, будучи вошедшим в систему как обычный пользователь.

*Злоупотребление:*

Как злоумышленник, я использую манипуляцию метаданными, такие как повторное использование или подделка токена доступа JSON Web Token (JWT) или куки-файла или скрытого поля, чтобы повысить привилегии или использовать недействительность JWT.

*Злоупотребление:*

Как злоумышленник, я эксплуатирую неправильную настройку Cross-Origin Resource Sharing (CORS), что позволяет несанкционированный доступ к API.

*Злоупотребление:*

Как злоумышленник, я принудительно просматриваю страницы, требующие аутентификации, как неаутентифицированный пользователь, или привилегированные страницы как стандартный пользователь.

*Злоупотребление:*

Как злоумышленник, я получаю доступ к API с отсутствующим управлением доступом для POST, PUT и DELETE запросов.

*Злоупотребление:*

Как злоумышленник, я нацеливаюсь на ключи криптографии по умолчанию, слабые ключи криптографии, которые были сгенерированы или повторно использованы, или ключи, для которых отсутствует ротация.

*Злоупотребление:*

Как злоумышленник, я нахожу области, где пользовательский агент (например, приложение, почтовый клиент) не проверяет, является ли полученный сертификат сервера действительным, и провожу атаки, в результате которых получаю несанкционированный доступ к данным.

#### A6:2017-Security Misconfiguration

*Epic:*

Злоумышленники часто пытаются эксплуатировать незапатченные уязвимости или получать доступ к учетным записям по умолчанию, неиспользуемым страницам, незащищенным файлам и каталогам и т.д., чтобы получить несанкционированный доступ или информацию о системе.

*Злоупотребление:*

Как злоумышленник, я нахожу и эксплуатирую отсутствие соответствующих настроек безопасности в любой части стека приложения или неправильно настроенные разрешения на облачных сервисах.

*Злоупотребление:*

Как злоумышленник, я нахожу ненужные функции, которые включены или установлены (например, ненужные порты, сервисы, страницы, учетные записи или привилегии), и атакую или эксплуатирую их слабости.

*Злоупотребление:*

Как злоумышленник, я использую учетные записи по умолчанию и их пароли для доступа к системам, интерфейсам или выполнения действий на компонентах, к которым я не должен иметь доступ.

*Злоупотребление:*

Как злоумышленник, я нахожу области приложения, где обработка ошибок раскрывает трассировки стека или другие чрезмерно информативные сообщения об ошибках, которые я могу использовать для дальнейшей эксплуатации.

*Злоупотребление:*

Как злоумышленник, я нахожу области, где обновленные системы или последние функции безопасности отключены или не настроены безопасно.

*Злоупотребление:*

Как злоумышленник, я нахожу настройки безопасности на серверах приложений, фреймворках приложений (например, Struts, Spring, ASP.NET), библиотеках, базах данных и т.д., которые не установлены на безопасные значения.

*Злоупотребление:*

Как злоумышленник, я нахожу, что сервер не отправляет заголовки безопасности или директивы или они установлены на небезопасные значения.

#### A7:2017-Cross-Site Scripting (XSS)

*Epic:*

XSS — это вторая по распространенности проблема в OWASP Top 10 и встречается примерно в двух третях всех приложений.

*Злоупотребление:*

Как злоумышленник, я провожу отраженный XSS, когда приложение или API включает непроверенный и неэкранированный пользовательский ввод в часть HTML-вывода. Моя успешная атака может позволить злоумышленнику выполнить произвольный HTML и JavaScript в браузере жертвы. Обычно жертве нужно взаимодействовать с какой-то вредоносной ссылкой, которая указывает на страницу, контролируемую злоумышленником, такую как вредоносные сайты, реклама или подобное.

*Злоупотребление:*

Как злоумышленник, я провожу сохраненный XSS, когда приложение или API сохраняет неочищенный пользовательский ввод, который просматривается позднее другим пользователем или администратором.

*Злоупотребление:*

Как злоумышленник, я провожу DOM XSS, когда JavaScript-фреймворки, одностраничные приложения и API, которые динамически включают данные, контролируемые злоумышленником, на страницу, уязвимы к DOM XSS.

#### A8:2017-Insecure Deserialization

*Epic:*

Эксплуатация десериализации несколько сложна, так как готовые эксплойты редко работают без изменений или доработок кода эксплойта.

*Злоупотребление:*

Как злоумышленник, я нахожу области приложения и API, где можно передать враждебные или измененные объекты для десериализации. В результате, я могу сосредоточиться на атаках на объект и структуру данных, где злоумышленник модифицирует логику приложения или достигает произвольного удаленного выполнения кода, если в приложении есть классы, которые могут изменить поведение во время или после десериализации. Либо я сосредоточусь на атаках на изменение данных, таких как атаки, связанные с управлением доступом, где используются существующие структуры данных, но изменяется их содержимое.

#### A9:2017-Using Components with Known Vulnerabilities

*Epic:*

Хотя легко найти готовые эксплойты для многих известных уязвимостей, другие уязвимости требуют сосредоточенных усилий для разработки кастомного эксплойта.

*Злоупотребление:*

Как злоумышленник, я нахожу общие пакеты с открытым или закрытым исходным кодом с уязвимостями и провожу атаки против уязвимостей и эксплойтов, которые были раскрыты.

#### A10:2017-Insufficient Logging & Monitoring

*Epic:*

Эксплуатация недостаточной регистрации и мониторинга является основой почти каждого крупного инцидента. Злоумышленники полагаются на отсутствие мониторинга и своевременного реагирования для достижения своих целей, оставаясь незамеченными. В 2016 году обнаружение нарушения занимало [в среднем 191 день](https://www-01.ibm.com/common/ssi/cgi-bin/ssialias?htmlfid=SEL03130WWEN), что давало значительный шанс на нанесение ущерба.

*Злоупотребление:*

Как злоумышленник, я атакую организацию, и журналы, системы мониторинга и команды не замечают или не реагируют на мои атаки.

## Sources of the schemas

Все фигуры были созданы с использованием <https://www.draw.io/>, и экспортированы в формате PNG для этого документа.

Все XML дескрипторы для каждой схемы доступны ниже (используя XML описания, модификация схем возможна при использовании DRAW.IO):

[Архив дескрипторов для схем](../assets/Abuse_Case_Cheat_Sheet_SchemaBundle.zip)
