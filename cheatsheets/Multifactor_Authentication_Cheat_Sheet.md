# Шпаргалка для многофакторной аутентификации

## Вступление

Многофакторная аутентификация (MFA) или двухфакторная аутентификация (2FA) - это когда пользователю требуется предоставить более одного типа доказательств для аутентификации в системе. Существует пять различных типов доказательств (или факторов), и можно использовать любую их комбинацию, однако на практике в веб-приложениях распространены только первые три. Ниже приведены пять типов:

| Фактор | Примеры |
|--------|----------|
| [Что-то, что ты знаешь](#что-то-что-ты-знаешь)| [Пароли и пин-коды](#пароли-и-pin-коды), [Секретные вопросы](#секретные-вопросы) |
| [Что-то, что у тебя есть](#что-то-что-у-тебя-есть) | [Токены OTP](#токены-с-одноразовым-паролем), [Токены U2F](#универсальный-второй-фактор), [Сертификаты](#сертификаты),[Смарт-карты](#смарт-карты), [Email](#email), [SMS и телефонные звонки](#sms-сообщения-и-телефонные-звонки) |
| [То-чем-ты-являешься](#то-чем-ты-являешься) | [Отпечатки пальцев, Распознавание лиц, Сканирование радужной оболочки глаза](#биометрические-данные) |
| [Где ты есть](#где-ты-есть) | [Исходный IP-адрес](#исходный-ip-адрес), [Геолокация](#геолокация), [Геозона](#геозона) |
| [Что-то, что ты делаешь](#что-то-что-ты-делаешь) | [Поведенческое профилирование](#behavioral-profiling), [Динамика нажатия клавиш и мыши](#динамика-нажатия-клавиш-и-мыши), [Анализ походки](#анализ-походки) |

Следует отметить, что требование использования нескольких экземпляров одного и того же фактора аутентификации (например, для ввода пароля и PIN-кода) **не является MFA** и обеспечивает минимальную дополнительную безопасность. Используемые факторы должны быть независимыми друг от друга и не должны быть скомпрометированы одной и той же атакой. Хотя в следующих разделах обсуждаются недостатки и уязвимые места различных типов MFA, во многих случаях они применимы только для защиты от целенаправленных атак. **Любое MFA лучше, чем отсутствие MFA**.

## Преимущества

Наиболее распространенным способом взлома учетных записей пользователей в приложениях является использование слабых, повторно используемых или украденных паролей. Несмотря на все технические средства защиты, реализованные в приложении, пользователи могут выбирать слабые пароли или использовать один и тот же пароль в разных приложениях. Как разработчики или системные администраторы, мы должны исходить из того, что пароли пользователей в какой-то момент будут скомпрометированы, и система должна быть спроектирована таким образом, чтобы защититься от этого.

MFA на сегодняшний день является лучшей защитой от большинства атак, связанных с использованием паролей, включая брутфорс, [утечку учетных данных](Credential_Stuffing_Prevention_Cheat_Sheet.md) и разбазаривание паролей. Анализ, проведенный Microsoft, показывает, что это остановило бы [99,9% атак на учетную запись compromises](https://techcommunity.microsoft.com/t5/Azure-Active-Directory-Identity/Your-Pa-word-doesn-t-matter/ba-p/731984).

## Недостатки

Самым большим недостатком MFA является усложнение управления как для администраторов, так и для конечных пользователей. Многим менее подготовленным пользователям может быть сложно настроить и использовать MFA. Кроме того, возникает ряд других распространенных проблем:

- Типы MFA, которые требуют от пользователей наличия определенного оборудования, могут привести к значительным затратам и административным накладным расходам.
- Пользователи могут лишиться доступа к своим учетным записям, если они потеряют или не смогут использовать другие свои учетные записи.
- MFA вносит дополнительную сложность в приложение.
- Многие решения MFA добавляют к системам внешние зависимости, которые могут создавать уязвимости в системе безопасности или отдельные точки сбоя.
- Процессы, реализованные для обхода или сброса MFA, могут быть использованы злоумышленниками.
- Требование MFA может помешать некоторым пользователям получить доступ к приложению.

## Краткие рекомендации

Точное время и способ реализации MFA в приложении зависит от ряда различных факторов, включая модель угроз приложения, технический уровень пользователей и уровень административного контроля над пользователями. Это необходимо учитывать в зависимости от конкретного приложения.

Тем не менее, приведенные ниже рекомендации, как правило, подходят для большинства приложений и являются отправной точкой для рассмотрения.

- Для всех пользователей требуется определенная форма MFA.
- Предоставьте пользователям возможность включить MFA в своих учетных записях с помощью [TOTP] (#программное обеспечение-otp-токены).
- Требовать MFA для пользователей с правами администратора или других пользователей с высокими привилегиями.
- Внедрить безопасную процедуру, позволяющую пользователям сбрасывать настройки MFA.
- Рассматривать [MFA как сервис] (#рассмотреть возможность использования стороннего сервиса).

## Реализация MFA

MFA является критически важным элементом управления безопасностью и рекомендуется для всех приложений. В следующих разделах приведены рекомендации по внедрению MFA и соображения, которые следует принимать во внимание.

### Нормативные требования и соответствие требованиям

Во многих отраслях и странах действуют нормативные акты, требующие использования MFA. Это особенно распространено в финансовом секторе и секторе здравоохранения и часто требуется для соблюдения Общего регламента по защите данных (GDPR) в Европейском союзе. Важно учитывать эти требования при внедрении MFA.

### Когда требуется MFA

Наиболее важным моментом для запроса MFA в приложении является вход пользователя в систему. Однако, в зависимости от доступных функций, может также потребоваться запрос MFA для выполнения конфиденциальных действий, таких как:

- Изменение паролей или секретных вопросов.
- Изменение адреса электронной почты, связанного с учетной записью.
- Отключение MFA.
- Повышение статуса сеанса пользователя до административного сеанса.

Если приложение предоставляет пользователю несколько способов аутентификации, все они должны требовать MFA или иметь другие средства защиты. Часто упускается из виду, что приложение предоставляет отдельный API, который можно использовать для входа в систему, или имеет связанное с ним мобильное приложение.

### Улучшение взаимодействия с пользователем

#### Аутентификация на основе рисков

Необходимость частого входа в систему с помощью MFA создает дополнительную нагрузку для пользователей и может привести к отключению MFA в приложении. Аутентификация на основе рисков может быть использована для уменьшения частоты запросов MFA, поскольку MFA требуется только тогда, когда пользователь выполняет действие, которое считается опасным. Некоторые примеры этого включают в себя:

- Требование MFA при входе пользователя в систему с нового устройства или местоположения.
- Требование MFA при входе пользователя в систему из местоположения, которое считается опасным.
- Разрешение диапазонов корпоративных IP-адресов (или использование [геолокации] (#geolocation) в качестве дополнительного фактора).

#### Ключи доступа

[Ключи доступа](https://passkeys.dev /), основанные на стандарте FIDO2, представляют собой новую форму MFA, которая сочетает в себе характеристики [основанного на владении](#что-то-у-вас-есть) и либо [основанного на знаниях](#что-то-вы-знаете), либо [основанного на наследственности](#что-то-вы-есть) аутентификация. Пользователь должен иметь физическое устройство (например, мобильный телефон) и ввести [PIN-код](#пароли и pin-коды) или использовать [биометрическую аутентификацию](#биометрические данные) для аутентификации. Затем устройство пользователя генерирует криптографический ключ, который используется для аутентификации на сервере. Это очень безопасная форма MFA, устойчивая к фишинговым атакам и в то же время не вызывающая затруднений у пользователя.

### Неудачные попытки входа в систему

Когда пользователь вводит свой пароль, но не может пройти аутентификацию с использованием второго фактора, это может означать одно из двух::

- Пользователь потерял свой второй фактор или не имеет его в наличии (например, у него нет мобильного телефона или отсутствует сигнал).
- Пароль пользователя был взломан.

В этом случае необходимо предпринять ряд шагов:

- Предложить пользователю попробовать другую форму MFA.
- Разрешить пользователю попытаться [сбросить настройки MFA](#сброс-настроек-mfa).
- Уведомлять пользователя о неудачной попытке входа в систему и рекомендовать ему сменить пароль, если он его не распознает.
    - В уведомлении должно быть указано время, браузер и географическое местоположение попытки входа в систему.
    - Это должно отображаться при следующем входе в систему и, при необходимости, отправляться по электронной почте.

### Сброс настроек MFA

Сброс MFA Одна из самых больших проблем при внедрении MFA - это работа с пользователями, которые забывают или теряют свои дополнительные сертификаты. Существует множество способов, которыми это может произойти, например,:

- Переустановка рабочей станции без резервного копирования цифровых сертификатов.
- Удаление или потеря телефона без резервного копирования OTP-кодов.
- Смена номера мобильного телефона.

Чтобы предотвратить блокировку доступа пользователей к приложению, необходим механизм, позволяющий им восстановить доступ к своей учетной записи, если они не могут использовать существующий MFA; однако также важно, чтобы это не давало злоумышленнику возможности обойти MFA и захватить их учетную запись.

Однозначного "наилучшего способа" сделать это не существует, и то, что является подходящим, будет сильно варьироваться в зависимости от безопасности приложения, а также уровня контроля над пользователями. Решения, которые подходят для корпоративного приложения, где все сотрудники знают друг друга, вряд ли будут применимы для общедоступного приложения с тысячами пользователей по всему миру. Каждый метод восстановления имеет свои преимущества и недостатки, и их необходимо оценивать в контексте конкретного приложения.

Некоторые рекомендации по возможным методам включают в себя:

- Предоставление пользователю нескольких одноразовых кодов восстановления при первой настройке MFA.
- Требуется, чтобы пользователь настраивал несколько типов MFA (например, цифровой сертификат, ядро OTP и номер телефона для SMS), так что маловероятно, что он потеряет доступ ко всем из них сразу.
- Отправка одноразового кода восстановления (или нового аппаратного токена) по почте на зарегистрированный адрес пользователя.
- От пользователя требуется связаться со службой поддержки и провести тщательную проверку его личности.
- Требуется, чтобы другой доверенный пользователь поручился за него.

### Рассмотрите возможность использования стороннего сервиса

Существует ряд сторонних сервисов, которые предоставляют MFA как услугу. Они могут быть хорошим вариантом для приложений, у которых нет ресурсов для самостоятельной реализации MFA, или для приложений, которым требуется высокий уровень надежности MFA. Однако важно учитывать безопасность стороннего сервиса и последствия его использования. Например, если сторонний сервис скомпрометирован, это может позволить злоумышленнику обойти MFA во всех приложениях, которые его используют.

## Что-то, что ты знаешь

Наиболее распространенный тип аутентификации, основанный на знаниях, основан на том, что известно пользователям - обычно это пароль. Самым большим преимуществом этого метода является то, что он предъявляет очень низкие требования как к разработчикам, так и к конечному пользователю, поскольку не требует какого-либо специального оборудования или интеграции с другими сервисами.

### Пароли и PIN-коды

Пароли и PIN-коды являются наиболее распространенной формой аутентификации из-за простоты их реализации. В [Шпаргалке для проверки подлинности](Authentication_Cheat_Sheet.md#implement-proper-password-strength-controls) содержатся рекомендации по внедрению политики надежной защиты паролей, а в [Шпаргалке для хранения паролей](Password_Storage_Cheat_Sheet.md) содержатся рекомендации по безопасному хранению паролей. Большинство систем многофакторной аутентификации используют пароль, а также, по крайней мере, еще один фактор.

#### Плюсы

- Простой и понятный.
- Встроенная поддержка во всех системах аутентификации.
- Простота в реализации.

#### Минусы

- Пользователи склонны выбирать ненадежные пароли.
- Пароли часто используются повторно в разных системах.
- Уязвимы для фишинга.

### Секретные вопросы

**Секретные вопросы больше не рассматриваются как приемлемый фактор аутентификации** согласно [NIST SP 800-63](https://pages.nist.gov/800-63-3/sp800-63b.html). Восстановление учетной записи - это всего лишь альтернативный способ аутентификации, поэтому он должен быть не слабее обычной аутентификации.

#### Плюсы

- Ничего такого, чего бы также не было в паролях.

#### Минусы

- Больше не считается приемлемым фактором аутентификации.
- Ответы на вопросы часто легко угадываются.
- Ответы на вопросы часто можно получить из социальных сетей или других источников.
- Вопросы должны быть тщательно подобраны, чтобы пользователи помнили ответы спустя годы.
- Уязвимы для фишинга.

## Что-то, что У Тебя есть

Аутентификация на основе владения основана на наличии у пользователя физического или цифрового объекта, необходимого для аутентификации. Это наиболее распространенная форма MFA, которая часто используется в сочетании с паролями. Наиболее распространенными типами аутентификации на основе владения являются аппаратные и программные токены, а также цифровые сертификаты. При правильной реализации удаленному злоумышленнику может быть значительно сложнее скомпрометировать систему; однако это также создает дополнительную административную нагрузку на пользователя, поскольку он должен иметь при себе средство аутентификации всякий раз, когда захочет его использовать.

### Токены с одноразовым паролем

Токены с одноразовым паролем (OTP) - это форма аутентификации на основе владения, при которой пользователь должен ввести постоянно меняющийся цифровой код для аутентификации. Наиболее распространенным из них являются токены одноразового пароля (OTP), основанные на времени, которые могут быть как аппаратными, так и программными.

#### Аппаратные OTP-токены

Аппаратные OTP-токены генерируют постоянно меняющиеся цифровые коды, которые необходимо вводить при аутентификации. Наиболее известным из них является [RSA SecureID](https://en.wikipedia.org/wiki/RSA_SecurID), который генерирует шестизначное число, меняющееся каждые 60 секунд.

##### Плюсы

- Поскольку токены представляют собой отдельные физические устройства, злоумышленнику практически невозможно взломать их удаленно.
- Токены можно использовать, не требуя от пользователя наличия мобильного телефона или другого устройства.

##### Минусы

- Предоставление физических токенов пользователям является дорогостоящим и сложным процессом.
- Если пользователь потеряет свой токен, на покупку и отправку нового может потребоваться значительное количество времени.
- Для некоторых реализаций требуется внутренний сервер, что может привести к появлению новых уязвимостей, а также к единой точке отказа.
- Украденные токены можно использовать без PIN-кода или кода разблокировки устройства.
- Уязвимы для фишинга (хотя и недолговечны).

#### Программные OTP-токены

Более дешевой и простой альтернативой аппаратным токенам является использование программного обеспечения для генерации одноразовых паролей на основе времени (TOTP). Обычно для этого пользователь устанавливает приложение TOTP на свой мобильный телефон, а затем сканирует QR-код, предоставляемый веб-приложением, которое предоставляет исходные данные. Затем приложение authenticator генерирует шестизначный номер каждые 60 секунд, почти так же, как аппаратный токен.

Большинство веб-сайтов используют стандартные токены TOTP, позволяющие пользователю установить любое приложение для проверки подлинности, поддерживающее TOTP. Однако небольшое количество приложений используют свои собственные варианты этого (например, Symantec), которые требуют от пользователей установки определенного приложения для использования сервиса. Этого следует избегать в пользу подхода, основанного на стандартах.

##### Плюсы

- Отсутствие физических токенов значительно снижает стоимость и административные издержки внедрения системы.
- Когда пользователи теряют доступ к своему приложению TOTP, можно настроить новое приложение без необходимости отправлять им физический токен.
- TOTP широко используется, и у многих пользователей уже установлено по крайней мере одно приложение TOTP.
- Пока у пользователя есть блокировка экрана на телефоне, злоумышленник не сможет использовать код в случае кражи телефона.

##### Минусы

- Приложения TOTP обычно устанавливаются на мобильные устройства, которые уязвимы для взлома.
- Приложение TOTP может быть установлено на том же мобильном устройстве (или рабочей станции), которое используется для аутентификации.
- Пользователи могут ненадежно хранить исходные файлы резервных копий.
- Не у всех пользователей есть мобильные устройства для использования с TOP.
- Если мобильное устройство пользователя потеряно, украдено или на нем разрядился аккумулятор, он не сможет пройти аутентификацию.
- Подвержен фишингу (хотя и недолговечен).

### Универсальный второй фактор

Аппаратные токены U2F

Universal Second Factor (U2F) - это стандарт для аппаратных токенов USB/NFC, который реализует аутентификацию на основе запроса-ответа, а не требует от пользователя ручного ввода кода. Обычно это делается нажатием кнопки на токене или касанием его к считывающему устройству NFC. Наиболее распространенным токеном U2F является [YubiKey](https://www.yubico.com/products/yubikey-hardware/).

#### Плюсы

- Токены U2F устойчивы к фишингу, поскольку закрытый ключ никогда не покидает токен.
- Пользователи могут просто нажать кнопку, а не вводить код.
- Поскольку токены представляют собой отдельные физические устройства, злоумышленнику практически невозможно взломать их удаленно.
- U2F изначально поддерживается рядом основных веб-браузеров.
- Токены U2F можно использовать, не требуя от пользователя наличия мобильного телефона или другого устройства.

#### Минусы

- Как и в случае с аппаратными OTP-токенами, использование физических токенов сопряжено со значительными затратами и административными накладными расходами.
- Украденные токены можно использовать без PIN-кода или кода разблокировки устройства.
- Поскольку токены обычно подключаются к рабочей станции через USB, пользователи, скорее всего, забудут их.

### Сертификаты

Цифровые сертификаты - это файлы, хранящиеся на устройстве пользователя, которые автоматически предоставляются вместе с паролем пользователя при аутентификации. Наиболее распространенным типом являются сертификаты X.509, более известные как [клиентские сертификаты](Transport_Layer_Security_Cheat_Sheet.md#клиентские-сертификаты-и-взаимный-протокол-tls). Сертификаты поддерживаются всеми основными веб-браузерами и после установки не требуют дополнительного взаимодействия с пользователем. Сертификаты должны быть привязаны к учетной записи пользователя, чтобы пользователи не пытались пройти аутентификацию с помощью других учетных записей.

#### Плюсы

- Нет необходимости приобретать аппаратные токены и управлять ими.
- После установки сертификаты становятся очень простыми для пользователей.
- Сертификатами можно централизованно управлять и отзывать их.
- Они устойчивы к фишингу.

#### Минусы

- Для использования цифровых сертификатов требуется внутренняя инфраструктура закрытых ключей (PKI).
- Установка сертификатов может быть сложной для пользователей, особенно в среде с высоким уровнем доступа.
- Корпоративные прокси-серверы, которые выполняют расшифровку SSL, не позволят использовать сертификаты.
- Сертификаты хранятся на рабочей станции пользователя и, как таковые, могут быть украдены в случае взлома его системы.

### Смарт-карты

Смарт-карты - это карты размером с кредитную карту с чипом, содержащим цифровой сертификат пользователя, который разблокируется с помощью PIN-кода. Они обычно используются для аутентификации в операционной системе, но редко используются в веб-приложениях.

#### Плюсы

- Украденные смарт-карты нельзя использовать без PIN-кода.
- Смарт-карты можно использовать в нескольких приложениях и системах.
- Они устойчивы к фишингу.

#### Минусы

- Управление смарт-картами и их распространение сопряжено с теми же затратами, что и аппаратные токены.
- Смарт-карты изначально не поддерживаются современными браузерами, поэтому требуется программное обеспечение сторонних производителей.
- Хотя в большинство ноутбуков бизнес-класса встроены считыватели смарт-карт, в домашних системах их часто нет.
- Для использования смарт-карт требуется серверная часть PK Is.

### SMS-сообщения и телефонные звонки

SMS-сообщения или телефонные звонки могут быть использованы для предоставления пользователям одноразового кода, который они должны ввести в качестве дополнительного фактора. Из-за рисков, связанных с этими методами, их не следует использовать для защиты приложений, хранящих личную информацию (PII), или там, где существует финансовый риск, например, в сфере здравоохранения и банковского дела. [NIST SP 800-63](https://pages.nist.gov/800-63-3/sp800-63b.html) не учитывает эти коэффициенты для приложений, содержащих личные данные.

#### Плюсы

- Относительно проста в реализации.
- Требуется, чтобы пользователь привязал свою учетную запись к номеру мобильного телефона.

#### Минусы

- Требуется, чтобы у пользователя было мобильное устройство или стационарный телефон.
- Требуется, чтобы у пользователя был сигнал или доступ в Интернет для приема вызова или сообщения.
- Отправка звонков и SMS-сообщений может стоить денег, что необходимо для защиты от злоумышленников, запрашивающих большое количество сообщений для исчерпания средств.
- Уязвимы для атак с подменой SIM-карты.
- SMS-сообщения могут быть получены на том же устройстве, с которого пользователь проходит аутентификацию.
- Подвержены фишингу.
- SMS-сообщения могут быть предварительно просмотрены, когда устройство заблокировано.
- SMS-сообщения могут быть прочитаны вредоносными или небезопасными приложениями.

### Email

Проверка по электронной почте требует, чтобы пользователь ввел код или перешел по ссылке, отправленной на его адрес электронной почты. Существуют некоторые споры о том, является ли электронная почта формой MFA, поскольку если у пользователя не настроена MFA на его учетной записи электронной почты, то для этого просто требуется знать пароль пользователя к электронной почте (который часто совпадает с паролем приложения). Однако для полноты картины она включена сюда.

#### Плюсы

- Очень проста в реализации.
- Нет требований к отдельному оборудованию или мобильному устройству.

#### Минусы

- Полностью зависит от безопасности учетной записи электронной почты, в которой часто отсутствует MFA.
- Пароли электронной почты обычно совпадают с паролями приложений.
- Не обеспечивает защиты, если электронная почта пользователя была взломана первой.
- Электронная почта может быть получена с того же устройства, с которого пользователь проходит аутентификацию.
- Подвержен фишингу.

## То, чем Ты являешься

Аутентификация на основе наследственности основана на физических атрибутах пользователя. Это менее распространено в веб-приложениях, поскольку требует от пользователя наличия определенного оборудования и часто считается наиболее агрессивным с точки зрения конфиденциальности. Однако он обычно используется для аутентификации в операционной системе, а также в некоторых мобильных приложениях.

### Биометрические данные

Используется несколько распространенных типов биометрических данных, в том числе:

- Сканирование отпечатков пальцев
- Распознавание лиц
- Сканирование радужной оболочки глаза
- Распознавание голоса

#### Плюсы

- Хорошо реализованные биометрические данные трудно подделать, и они требуют целенаправленной атаки.
- Быстро и удобно для пользователей.

#### Минусы

- Пользователь должен зарегистрироваться вручную.
- Для считывания биометрических данных часто требуется специальное (иногда дорогостоящее) оборудование.
- Конфиденциальность: необходимо хранить конфиденциальную физическую информацию о пользователях.
- В случае взлома биометрические данные может быть трудно изменить.
- Аппаратное обеспечение может быть уязвимо для дополнительных векторов атак.

## Где ты есть

Аутентификация на основе местоположения основана на физическом местоположении пользователя. Иногда утверждается, что местоположение используется при принятии решения о том, требовать или не требовать MFA (как обсуждалось [выше](#когда-требуется-mfa)), однако это фактически то же самое, что рассматривать его как самостоятельный фактор. Двумя яркими примерами этого являются [Политики условного доступа] (https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/overview), доступные в Microsoft Azure, и функциональность [Сеть Unlock](https://docs.microsoft.com/en-us/windows/security/information-protection/bitlocker/bitlocker-how-to-enable-network-unlock) в BitLocker.

### Исходный IP-адрес

Исходный IP-адрес, с которого подключается пользователь, может использоваться в качестве фактора, обычно при использовании подхода, основанного на списке разрешений. Это может быть либо статический список (например, диапазоны офисов компании), либо динамический список (например, предыдущие IP-адреса, с которых пользователь проходил аутентификацию).

#### Плюсы

- Очень прост для пользователей.
- Требует минимальной настройки и управления со стороны административного персонала.

#### Минусы

- Не обеспечивает никакой защиты в случае взлома системы пользователя.
- Не обеспечивает никакой защиты от несанкционированного доступа.
- Надежные IP-адреса должны быть строго ограничены (например, если открытый гостевой Wi-Fi использует основной корпоративный IP-диапазон).

### Геолокация

Вместо того, чтобы использовать точный IP-адрес пользователя, можно использовать географическое местоположение, в котором зарегистрирован IP-адрес. Это менее точно, но может оказаться более целесообразным для реализации в средах, где IP-адреса не являются статичными. Обычно при попытке аутентификации из-за пределов обычной страны пользователя требуются дополнительные факторы аутентификации.

#### Плюсы

- Очень прост для пользователей.

#### Минусы

- Не обеспечивает никакой защиты в случае взлома системы пользователя.
- Не обеспечивает никакой защиты от несанкционированного доступа.
- Злоумышленнику легко обойти защиту, получив IP-адреса в стране или местоположении, которым он доверяет.
- Функции конфиденциальности, такие как [iCloud Private Relay] от Apple (https://support.apple.com/en-us/102602) и VPN, могут сделать это менее точным.

### Геозона

Геозона - это более точная версия геолокации, которая позволяет пользователю определить конкретную область, в которой ему разрешено проходить аутентификацию. Это часто используется в мобильных приложениях, где местоположение пользователя может быть определено с высокой степенью точности с помощью аппаратных средств геопозиционирования, таких как GPS.

#### Плюсы

- Очень прост для пользователей.
- Обеспечивает высокий уровень защиты от удаленных злоумышленников.

#### Минусы

- Не обеспечивает никакой защиты в случае взлома системы пользователя.
- Не обеспечивает никакой защиты от несанкционированного доступа.
- - Не обеспечивает никакой защиты от злоумышленников, которые находятся физически близко к надежному местоположению.on.

## Что-то, что Ты делаешь

Аутентификация на основе поведения основана на поведении пользователя, например, на том, как он печатает, двигает мышью или использует мобильное устройство. Это наименее распространенная форма MFA, которая в сочетании с другими факторами повышает уровень надежности идентификации пользователя. Он также является наиболее сложным в реализации и может потребовать специального оборудования, а также значительного объема данных и вычислительной мощности для анализа поведения пользователя.

### Поведенческое профилирование

Поведенческое профилирование основано на том, как пользователь взаимодействует с приложением, например, в какое время суток он входит в систему, какие устройства он использует и как он перемещается по приложению. Это быстро становится все более распространенным в веб-приложениях в сочетании с системами [Аутентификации на основе рисков] (#risk-based-authentication) и [Поведения пользователей и сущностей Analytics](https://learn.microsoft.com/en-us/azure/sentinel/identify-threats-with-entity-behavior-analytics) (UEBA).

#### Плюсы

- Не требует взаимодействия с пользователем.
- Может использоваться для постоянной аутентификации пользователя.
- Хорошо сочетается с другими факторами для повышения уровня надежности идентификации пользователя.

#### Минусы

- Ранние реализации поведенческого профилирования часто были неточными и приводили к значительному количеству ложных срабатываний.
- Для анализа поведения пользователя требуются большие объемы данных и вычислительная мощность.
- Может быть сложно реализовать в средах, где поведение пользователя, вероятно, часто меняется.

### Динамика нажатия клавиш и мыши

Динамика нажатия клавиш и мыши зависит от того, как пользователь вводит текст и перемещает мышь. Например, время между нажатиями клавиш, время между нажатием и отпусканием клавиш, а также скорость и ускорение мыши. В основном это теоретические данные, которые не находят широкого применения на практике.

#### Плюсы

- Может использоваться без использования какого-либо дополнительного оборудования.
- Может использоваться без какого-либо дополнительного взаимодействия с пользователем.
- Может использоваться для постоянной аутентификации пользователя.
- Может использоваться для определения того, использует ли систему не пользователь.
- Может использоваться для определения того, когда пользователь находится под давлением.
- Может использоваться для определения того, когда пользователь не в состоянии использовать систему.

#### Минусы

- Вряд ли он будет достаточно точным, чтобы использовать его как самостоятельный фактор.
- Может быть подделан искусственным интеллектом или другими продвинутыми атаками.

### Анализ походки

Анализ походки основан на том, как ходит пользователь, с помощью камер и датчиков. Они часто используются в системах физической безопасности, но не находят широкого применения в веб-приложениях. Приложения для мобильных устройств могут использовать акселерометр для определения походки пользователя и использовать это как дополнительный фактор, однако это все еще в значительной степени теоретически.

#### Плюсы

- Очень трудно подделать.
- Может использоваться без каких-либо дополнительных действий со стороны пользователя.

#### Минусы

- Для реализации требуется специальное оборудование.
- Использование вне систем физической безопасности широко не тестировалось.

## Ссылки и дальнейшее чтение

- [NIST SP 800-63](https://pages.nist.gov/800-63-3/sp800-63b.html)
- [Your Pa$$word doesn't matter](https://techcommunity.microsoft.com/t5/Azure-Active-Directory-Identity/Your-Pa-word-doesn-t-matter/ba-p/731984)
- [FIDO2](https://fidoalliance.org/fido2/)
- [ENISA Handbook on Security of Personal Data Processing](https://www.enisa.europa.eu/publications/handbook-on-security-of-personal-data-processing/@@download/fullReport)
- [Google Cloud Adding MFA](https://cloud.google.com/identity-platform/docs/web/mfa)
