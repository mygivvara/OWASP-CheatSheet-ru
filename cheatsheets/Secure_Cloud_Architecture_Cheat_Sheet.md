# Шпаргалка по безопасности облачной архитектуры

## Вступление

В этом руководстве-шпаргалке будут рассмотрены общие и необходимые шаблоны безопасности, которым следует следовать при создании и анализе облачных архитектур. В каждом разделе будут рассмотрены конкретные рекомендации по безопасности или решения по проектированию облака, которые следует учитывать. Этот лист написан для средне- и крупномасштабной корпоративной системы, поэтому будут рассмотрены дополнительные накладные расходы, которые могут оказаться ненужными для небольших организаций.

## Анализ рисков, моделирование угроз и оценка поверхности атаки

В любой архитектуре приложений понимание рисков и угроз чрезвычайно важно для обеспечения надлежащей безопасности. Никто не может потратить весь свой бюджет или пропускную способность на обеспечение безопасности, поэтому необходимо правильно распределять ресурсы безопасности.
Поэтому предприятия должны проводить оценку рисков, моделирование угроз и оценку поверхности атаки, чтобы определить следующее:

- С какими угрозами может столкнуться приложение
- Вероятность того, что эти угрозы проявятся в виде атак
- Поверхность атаки, с помощью которой эти атаки могут быть нацелены
- Влияние потери данных или функциональности в результате указанной атаки на бизнес

Все это необходимо для надлежащего определения уровня безопасности архитектуры. Однако эти темы можно/нужно обсудить более подробно. Воспользуйтесь приведенной ниже ссылкой на ресурсы для дальнейшего изучения в рамках обсуждения вопросов, связанных с безопасной архитектурой.

- [Шпаргалка по моделированию угроз](https://cheatsheetseries.owasp.org/cheatsheets/Threat_Modeling_Cheat_Sheet.html)
- [Шпаргалка для анализа поверхности атаки](https://cheatsheetseries.owasp.org/cheatsheets/Attack_Surface_Analysis_Cheat_Sheet.html)
- [Оценка киберрисков CISA](https://www.cisa.gov/sites/default/files/2023-02/22_1201_safecom_guide_to_cybersecurity_risk_assessment_508-r1.pdf)

## Государственные и частные компоненты

### Безопасное хранение объектов

Объектное хранилище обычно имеет следующие возможности доступа к данным:

- Доступ к ресурсам с использованием встроенных политик идентификации и управления доступом
- Использование криптографически подписанных URL-адресов и HTTP-запросов
- Прямой доступ к общедоступному хранилищу

#### Доступ через IAM 

Этот метод предполагает непрямой доступ к инструментам, таким как управляемая или самоуправляемая служба, работающая на временной или постоянной инфраструктуре. Эта инфраструктура содержит постоянные учетные данные IAM уровня управления, которые взаимодействуют с хранилищем объектов от имени пользователя. Этот метод лучше всего использовать, когда в приложении доступны другие пользовательские интерфейсы или системы обработки данных, когда важно скрыть как можно большую часть системы хранения или когда информация не должна/не будет видна конечному пользователю (метаданные). Его можно использовать в сочетании с веб-аутентификацией и ведением журнала, чтобы лучше отслеживать и контролировать доступ к ресурсам. Ключевой проблемой безопасности при таком подходе является использование разработанного кода или политик, которые могут содержать слабые места.

|                          Плюсы                         |                                   Минусы                                   |
|:------------------------------------------------------:|:--------------------------------------------------------------------------:|
|              Нет прямого доступа к данным              |               Потенциальное использование широкой политики IAM             |
| Отсутствие доступа пользователя к объектному хранилищу | Потеря учетных данных открывает доступ к API-интерфейсам уровня управления |
|        Идентифицируемый и регистрируемый доступ        |                Учетные данные могут быть жестко закодированы               |

Такой подход приемлем для конфиденциальных пользовательских данных, но для обеспечения надлежащей защиты данных необходимо строго соблюдать правила кодирования и лучшие облачные практики.

#### Подписанные URL-адреса

Подписание URL-адресов для хранилища объектов предполагает использование некоторого метода или статической или динамической генерации URL-адресов, которые криптографически гарантируют, что объект может получить доступ к ресурсу в хранилище. Это лучше всего использовать, когда необходим или предпочтителен прямой доступ к определенным пользовательским файлам, поскольку при этом не возникает затрат на передачу файлов. Рекомендуется использовать этот метод только для тех пользовательских данных, которые не являются особо конфиденциальными. Этот метод может быть безопасным, но имеет существенные недостатки. Внедрение кода все еще возможно, если метод генерации подписанного URL-адреса является пользовательским, динамическим и поддающимся внедрению, и любой желающий может получить доступ к ресурсу анонимно, если ему указан URL-адрес. Разработчики также должны учитывать, истекает ли срок действия подписанного URL-адреса и когда, что усложняет подход.

|                          Плюсы                         |                         Минусы                         |
|:------------------------------------------------------:|:------------------------------------------------------:|
|              Доступ только к одному ресурсу            |                     Анонимный доступ                   |
| Минимальный доступ пользователя к объектному хранилищу |   Любой желающий может получить доступ по URL-адресу   |
|                Эффективная передача файлов             | Возможность внедрения с помощью пользовательского кода |

#### Хранилище общедоступных объектов

**Это нецелесообразный метод хранения и распространения ресурсов**, и его следует использовать только для общедоступных, конфиденциальных, универсальных ресурсов. Такой подход к хранению данных позволит злоумышленникам провести дополнительную разведку в облачной среде, и любые данные, которые хранятся в этой конфигурации в течение любого периода времени, должны рассматриваться как общедоступные (утечка информации).

|                 Плюсы                 |                          Минусы                          |
|:-------------------------------------:|:--------------------------------------------------------:|
| Эффективный доступ ко многим ресурсам | Любой может получить доступ / Никакой конфиденциальности |
| Простой общедоступный файловый ресурс |            Неавторизованный доступ к объектам            |
|                                       |              Доступ ко всей файловой системе             |
|                                       |         Случайная утечка сохраненной информации          |

### VPC и подсети

Виртуальные частные облака (VPC) и подсети общедоступной/частной сети позволяют сегментировать приложение и его сеть на отдельные блоки, повышая уровень безопасности облачной системы. В отличие от других компромиссов между частным и общедоступным, приложение, скорее всего, будет включать большинство или все эти компоненты в зрелой архитектуре. Каждый из них описан ниже.

#### VPCs

VPC используются для создания сетевых границ внутри приложения, в которых компоненты могут взаимодействовать друг с другом, подобно физической сети в центре обработки данных. VPC будет состоять из некоторого количества подсетей, как общедоступных, так и частных. VPC могут использоваться для:

- Разделяйте целые приложения в рамках одной облачной учетной записи.
- Разделяйте крупные компоненты приложения на отдельные VPC с изолированными сетями.
- Создавайте разделители между дублирующимися приложениями, используемыми для разных клиентов или наборов данных.

#### Общедоступные подсети

В общедоступных подсетях размещаются компоненты, которые будут подключены к Интернету. Подсеть будет содержать элементы сетевой маршрутизации, позволяющие компонентам внутри подсети напрямую подключаться к Интернету. Некоторые варианты использования включают:

- Общедоступные ресурсы, такие как интерфейсные веб-приложения.
- Начальные точки соприкосновения для приложений, таких как балансировщики нагрузки и маршрутизаторы.
- Точки доступа разработчика, такие как [bastions](https://aws-quickstart.github.io/quickstart-linux-bastion/) (обратите внимание, что они могут быть очень небезопасными, если спроектированы/развернуты неправильно).

#### Частные подсети

Частные подсети содержат компоненты, которые не должны иметь прямого доступа к Интернету. Подсеть, скорее всего, будет содержать сетевую маршрутизацию для подключения к общедоступным подсетям, чтобы получать интернет-трафик структурированным и защищенным способом. Частные подсети отлично подходят для:

- Баз данных и хранилищ данных.
- Внутренние серверы и связанные с ними файловые системы.
- Все, что считается слишком конфиденциальным для прямого доступа в Интернет.

#### Простой пример архитектуры

Рассмотрим простую архитектурную схему, приведенную ниже. На виртуальном компьютере будут размещены все компоненты приложения, но элементы будут находиться в определенной подсети в зависимости от его роли в системе. Обычный процесс взаимодействия с этим приложением может выглядеть следующим образом:

1. Доступ к приложению осуществляется через какой-либо интернет-шлюз, API-шлюз или другой компонент, подключенный к Интернету.
2. Этот шлюз подключается к балансировщику нагрузки или веб-серверу в общедоступной подсети. Оба компонента предоставляют общедоступные функции и защищены соответствующим образом.
3. Затем эти компоненты взаимодействуют со своими соответствующими серверными аналогами, базой данных или серверным сервером, расположенными в частном VPC. Эти соединения более ограничены, что предотвращает посторонний доступ к, возможно, "мягким" серверным системам.

![Диаграмма VPC](../assets/Secure_Cloud_Architecture_VPC.png)

*Примечание: На этой диаграмме намеренно пропущены элементы маршрутизации и элементы элементов для взаимодействия с подсетями, для простоты и независимости от поставщика услуг.*

Такая архитектура предотвращает прямой доступ к Интернету менее защищенных серверных компонентов или служб с более высоким уровнем риска, таких как базы данных. Она также обеспечивает общий, общедоступный функциональный доступ к Интернету, что позволяет избежать дополнительных затрат на маршрутизацию. Эту архитектуру можно упростить, сосредоточив внимание на безопасности в точках входа и разделив функциональность, поместив закрытую или конфиденциальную информацию в частную подсеть, где внешним сторонам будет труднее получить к ней доступ.

## Границы доверия

Границы доверия - это связи между компонентами в системе, при которых решение о доверии должно приниматься самими компонентами. Другими словами, эта граница - это точка, в которой встречаются два компонента с потенциально разными уровнями доверия. Эти границы могут варьироваться по масштабу, от степени доверия, предоставляемой пользователям, взаимодействующим с приложением, до доверия или проверки конкретных утверждений между функциями кода или компонентами в облачной архитектуре. Однако, в целом, достаточно доверять правильному и безопасному выполнению функций каждым компонентом. Таким образом, границы доверия, скорее всего, возникнут в соединениях между облачными компонентами, а также между приложением и сторонними элементами, такими как конечные пользователи и другие поставщики.

В качестве примера рассмотрим архитектуру, представленную ниже. Шлюз API подключается к вычислительному экземпляру (временному или постоянному), который затем получает доступ к ресурсу постоянного хранилища. Отдельно существует сервер, который может проверять аутентификацию, авторизацию и/или идентификационные данные вызывающего устройства. Это общее представление OAuth, I AM или системы каталогов, которая управляет доступом к этим ресурсам. Кроме того, существует временный сервер IAM, который управляет доступом к сохраненным ресурсам (используя подход, подобный [Доступ через IAM] (#iam-access) в разделе выше). Как показано пунктирными линиями, границы доверия существуют между каждым вычислительным компонентом, шлюзом API и сервером аутентификации, даже если многие или все элементы могут находиться в одном приложении.

![Границы доверия](../assets/Secure_Cloud_Architecture_Trust_Boundaries_1.png)

### Изучение различных уровней доверия

Архитекторы должны выбрать конфигурацию доверия между компонентами, используя количественные факторы, такие как оценка риска/толерантность, скорость проекта, а также субъективные цели в области безопасности. В каждом примере ниже подробно описываются границы доверия, чтобы лучше объяснить последствия доверия к определенному ресурсу. Уровень угрозы для конкретного ресурса в виде цвета от зеленого (безопасный) до красного (опасный) указывает, каким ресурсам не следует доверять.

#### 1. Пример отсутствия доверия

Как показано на диаграмме ниже, в этом примере описана модель, в которой ни один компонент не доверяет никакому другому компоненту, независимо от критичности или уровня угрозы. Такой тип конфигурации доверия, скорее всего, будет использоваться для приложений с невероятно высоким уровнем риска, где содержатся либо очень личные данные, либо важные бизнес-данные, либо где приложение в целом имеет чрезвычайно высокую бизнес-критичность.

Обратите внимание, что и шлюз API, и вычислительные компоненты обращаются к серверу аутентификации. Это означает, что никакие данные, передаваемые между этими компонентами, даже если они находятся рядом друг с другом "внутри" приложения, не считаются надежными. Затем вычислительный экземпляр должен получить временный идентификатор для доступа к хранилищу, поскольку вычислительному экземпляру не доверен определенный ресурс, даже если пользователь доверен экземпляру.

Также обратите внимание на отсутствие доверия между сервером аутентификации/удостоверения личности и временным сервером IAM и каждым компонентом. Хотя это и не показано на диаграмме, это может привести к дополнительным последствиям, таким как более тщательные проверки перед аутентификацией и, возможно, к увеличению затрат на криптографические операции.

![Отсутствие взаимного доверия](../assets/Secure_Cloud_Architecture_Trust_Boundaries_2.png)

Это может быть необходимым подходом для приложений, используемых в финансовых, военных или критически важных инфраструктурных системах. Однако при выборе этой модели следует проявлять осторожность в вопросах безопасности, поскольку она будет иметь существенные недостатки в производительности и обслуживании.

|               Плюсы                 |          Минусы           |
|:-----------------------------------:|:-------------------------:|
| Высокая гарантия целостности данных | Медленная и неэффективная |
|           Глубокая защита           |          Сложная          |
|                                     |   Скорее всего, дорогая   |

#### 2. Пример высокого доверия

Далее рассмотрим противоположный подход, при котором все является надежным. В этом случае "опасный" пользовательский ввод является надежным и, по сути, передается непосредственно бизнес-компоненту с высокой степенью критичности. Ресурс аутентификации вообще не используется. В этом случае вероятность успешной атаки на систему выше, поскольку для ее предотвращения нет средств управления. Кроме того, такая настройка может быть сочтена расточительной, поскольку как серверы аутентификации/удостоверения личности, так и временные серверы IAM не обязательно выполняют свои функции по назначению. * (Это могут быть общие корпоративные ресурсы, которые используются не в полной мере).*

![Границы полного доверия ](../assets/Secure_Cloud_Architecture_Trust_Boundaries_3.png)

Такая архитектура вряд ли подойдет для всех приложений, кроме самых простых и с наименьшим риском. **Не используйте эту конфигурацию границ доверия**, если только нет конфиденциального контента, который необходимо защитить, или эффективность не является единственным критерием успеха. Никогда не рекомендуется доверять вводимым пользователем данным, даже в приложениях с низким уровнем риска.

|    Плюсы    |            Минусы           |
|:-----------:|:---------------------------:|
| Эффективная |        Небезопасная         |
|   Простая   | Потенциально расточительная |
|             |  Высокий риск компрометации |

#### 3. Пример малого доверия

Большинство приложений используют подобную конфигурацию границ доверия. Используя знания, полученные в результате анализа рисков и атак на поверхности, служба безопасности может обоснованно назначить доверие компонентам или процессам с низким уровнем риска и проверять их только при необходимости. Это предотвращает растрату ценных ресурсов безопасности, но также снижает сложность и эффективность из-за дополнительных затрат на обеспечение безопасности.

Обратите внимание, что в этом примере шлюз API проверяет аутентификацию пользователя, а затем немедленно передает запрос вычислительному экземпляру. Экземпляру не требуется повторная проверка, и он выполняет свою операцию. Однако, поскольку вычислительный экземпляр работает с ненадежными пользовательскими данными (обозначенными желтым цветом для некоторого доверия), для доступа к системе хранения данных по-прежнему необходимо использовать эфемерную идентификационную информацию.

![Границы малого доверия](../assets/Secure_Cloud_Architecture_Trust_Boundaries_4.png)

По своей природе, этот подход ограничивает плюсы и минусы обоих предыдущих примеров. Эта модель, вероятно, будет использоваться для большинства приложений, за исключением случаев, когда преимущества приведенных выше примеров необходимы для удовлетворения бизнес-требований.

|                              Плюсы                             |                  Минусы                  |
|:--------------------------------------------------------------:|:----------------------------------------:|
|                Обеспечение, основанное на риске                | Известные пробелы в системе безопасности |
| Соотношение затрат и эффективности, обусловленное критичностью |                                          |

*Примечание: Эта методология отличается от нулевого уровня доверия. Для более подробного изучения этой темы ознакомьтесь с [Моделью зрелости CISA с нулевым уровнем доверия](https://www.cia.gov/sites/default/files/2023-04/zero_trust_maturity_model_v2_508.pdf)*.

## Инструменты обеспечения безопасности

### Брандмауэр веб-приложений

Брандмауэры веб-приложений (WAF) используются для мониторинга или блокирования распространенных атак (таких как [XSS](https://owasp.org/www-community/attacks/xss/) и [SQLi](https://owasp.org/www-community/attacks/SQL_Injection)) или разрешают только определенные типы запросов и шаблоны. Приложения должны использовать их в качестве первой линии защиты, подключая к точкам входа, таким как средства балансировки нагрузки или шлюзы API, для обработки потенциально вредоносного контента до того, как он достигнет кода приложения. Поставщики облачных услуг разрабатывают базовые наборы правил, которые будут блокировать или отслеживать распространенные вредоносные программы.:

- [Правила AWS](https://docs.aws.amazon.com/waf/latest/developerguide/aws-managed-rule-groups-list.html)
- [Правила GCP WAF](https://cloud.google.com/armor/docs/waf-rules)
- [Основные наборы правил Azure](https://learn.microsoft.com/en-us/azure/web-application-firewall/ag/application-gateway-crs-rulegroups-rules?tabs=owasp32)

По своей сути эти наборы правил являются универсальными и не будут охватывать все типы атак, с которыми может столкнуться приложение. Рассмотрите возможность создания пользовательских правил, которые будут соответствовать конкретным потребностям приложения в области безопасности, например:

- Фильтрация маршрутов к приемлемым конечным точкам (блокировка веб-сканирования)
- Добавление специальных средств защиты для выбранных технологий и ключевых конечных точек приложений
- Ограничение скорости работы уязвимых API

### Ведение журнала и мониторинг

Ведение журнала и мониторинг необходимы для обеспечения подлинной безопасности приложения. Разработчики должны точно знать, что происходит в их среде, и использовать механизмы оповещения, чтобы предупредить инженеров, когда системы работают не так, как ожидалось. Кроме того, в случае инцидента с безопасностью ведение журнала должно быть достаточно подробным, чтобы отслеживать источник угрозы во всем приложении, и предоставлять респондентам достаточно информации, чтобы понять, какие действия были предприняты против каких ресурсов. Обратите внимание, что надлежащее ведение журнала и мониторинг могут быть дорогостоящими, и при организации ведения журнала следует учитывать соотношение рисков и затрат.

#### Ведение журнала

Для правильного ведения журнала учитывайте:

- Ведение журнала всех [уровень 7](https://en.wikipedia.org/wiki/OSI_model) HTTP-вызовов с заголовками, метаданными вызывающего абонента и ответами
    - Полезная нагрузка может не регистрироваться в зависимости от того, где происходит регистрация (до завершения TLS) и конфиденциальности данных
- Ведение журнала внутренних действий с информацией об участнике и разрешениях
- Отправка идентификаторов отслеживания на протяжении всего жизненного цикла запроса для отслеживания ошибок или вредоносных действий
- Маскировка или удаление конфиденциальных данных
    - SSN, конфиденциальная медицинская информация и другие личные данные не должны храниться в журналах

*Представители юридических служб и службы соблюдения нормативных требований должны учитывать сроки хранения журналов для конкретного приложения.*

#### Мониторинг

Для надлежащего мониторинга рассмотрите возможность добавления:

- Предупреждения об аномалиях:
    - Ошибки HTTP 4xx и 5xx превышают процент от нормы
    - Загрузка памяти, накопителей или процессора выше/ниже процента от нормальной
    - Запись/считывание из базы данных выше/ниже процента от нормы
    - Количество обращений к вычислениям без сервера превышает процент от обычного
- Оповещение о неудачных проверках работоспособности
- Оповещение об ошибках развертывания или циклическом включении/выключении контейнера
- Предупреждения или ограничения по лимитам затрат

Количество и тип аномалий могут сильно различаться в разных приложениях. Для правильного понимания того, что считается аномалией, требуется исходный уровень, специфичный для конкретной среды. Поэтому указанные выше процентные показатели следует выбирать исходя из этого базового уровня, в дополнение к таким соображениям, как риск и способность команды реагировать.

Количество и тип аномалий могут сильно различаться в разных приложениях. Для правильного понимания того, что считается аномалией, требуется исходный уровень, специфичный для конкретной среды. Поэтому указанные выше процентные показатели следует выбирать исходя из этого базового уровня, в дополнение к таким соображениям, как риск и способность команды реагировать.

### Защита от DDoS-атак

Поставщики облачных услуг предлагают ряд продуктов для защиты от DDoS-атак, от простых до продвинутых, в зависимости от потребностей приложений. Простая защита от DDoS-атак часто может быть реализована с использованием WAFS с ограничениями скорости и правилами блокировки маршрутов. Для более продвинутой защиты могут потребоваться специальные управляемые инструменты, предлагаемые поставщиком облачных услуг. В качестве примеров можно привести:

- [AWS Shield](https://aws.amazon.com/shield/)
- [GCP Cloud Armor Managed Protection](https://cloud.google.com/armor/docs/managed-protection-overview)
- [Azure DDoS Protection](https://learn.microsoft.com/en-us/azure/ddos-protection/ddos-protection-overview)

Решение о включении расширенной защиты от DDoS-атак для конкретного приложения должно основываться на оценке рисков и бизнес-критичности приложения, принимая во внимание смягчающие факторы и стоимость (эти услуги могут быть очень недорогими по сравнению с крупными бюджетами компаний).

## Модель совместной ответственности

Модель совместной ответственности - это основа для поставщиков облачных услуг (CSP) и тех, кто продает облачные сервисы, позволяющая правильно определить и распределить обязанности разработчика и поставщика. Она разбита на различные уровни контроля, соответствующие различным элементам/уровням стека технологий. Как правило, за такие компоненты, как физические вычислительные устройства и пространство в центре обработки данных, отвечает CSP. В зависимости от уровня [управления] (#self-managed-tooling) разработчик может отвечать за весь стек, начиная с операционной системы и выше, или только за некоторые вспомогательные функции, код или администрирование.

Эта модель ответственности часто подразделяется на три уровня обслуживания, которые называются:

- Инфраструктура как услуга ([IaaS](#iaas))
- Платформа как услуга ([PaaS](#paas))
- Программное обеспечение как услуга ([SaaS](#saas))

*Существует множество других классификаций услуг, но они не приведены в списке для простоты и краткости изложения.*

Как следует из названия, уровень ответственности, который берет на себя CSP, определяется уровнем предоставляемого "услуги". Каждый уровень имеет свои плюсы и минусы, которые обсуждаются ниже.

### IaaS

В случае IaaS инфраструктура поддерживается CSP, в то время как все остальное поддерживается разработчиком. Это включает в себя:

- Аутентификация и авторизация
- Хранение данных, доступ к ним и управление ими
- Некоторые сетевые задачи (порты, NACL и т.д.)
- Прикладное программное обеспечение

Эта модель обеспечивает конфигурируемость и гибкость для разработчиков, но при этом является более сложной и, как правило, более дорогостоящей, чем другие модели обслуживания. Она также больше всего напоминает локальные модели, популярность которых в крупных компаниях снижается. Из-за этого может оказаться проще перенести определенные приложения на облачный IaaS, чем перестраивать их на более облачную архитектуру.

|                  Плюсы                  |                     Минусы                    |
|:---------------------------------------:|:---------------------------------------------:|
|  Контроль над большинством компонентов  |             Самая высокая стоимость           |
|         Высокий уровень гибкости        | Больше необходимого технического обслуживания |
| Легкий переход от локального размещения |           Высокий уровень сложности           |

**Ответственность лежит почти исключительно на разработчике и должна быть обеспечена как таковая**. При разработке стратегии безопасности IaaS необходимо учитывать все, начиная от контроля доступа к сети, уязвимостей операционной системы, уязвимостей приложений, доступа к данным и аутентификации/авторизации. Как описано выше, это обеспечивает высокий уровень контроля практически во всем технологическом стеке, но может быть очень сложно поддерживать без достаточных ресурсов, выделяемых на такие задачи, как обновление версий или миграция по истечении срока службы. *([Автономные обновления для системы безопасности] (#update-strategy-for-self-managed-services) более подробно обсуждается ниже.)*

### PaaS

Платформа как услуга находится посередине между IaaS и SaaS. Разработчик контролирует:

- Аутентификацию и авторизацию приложений
- Прикладное программное обеспечение
- Внешнее хранилище данных

PaaS предоставляет аккуратно упакованный хостинг кода и контейнерные опции, которые позволяют небольшим командам разработчиков или менее опытным разработчикам приступить к работе со своими приложениями, игнорируя при этом более сложные или лишние вычислительные задачи. Как правило, это дешевле, чем IaaS, но при этом сохраняется некоторый контроль над элементами, которые система SaaS не предоставляет. Однако у разработчиков могут возникнуть проблемы с конкретными ограничениями используемого предложения или с совместимостью, поскольку код должен работать с правильным контейнером, платформой или языковой версией.

Кроме того, хотя масштабируемость в значительной степени зависит от поставщика и настроек, PaaS обычно обеспечивает более высокую масштабируемость благодаря возможностям контейнеризации и общим, повторяемым базовым системам операционной системы. По сравнению с IaaS, где масштабируемость должна быть обеспечена разработчиком, и SaaS, где производительность сильно зависит от платформы.

|                Плюсы                |                  Минусы                 |
|:-----------------------------------:|:---------------------------------------:|
| Проще в эксплуатации и обслуживании | Потенциальные проблемы с совместимостью |
|        Лучшая масштабируемость      |     Предлагающие особые ограничения     |

Защита, выполняемая вручную, в решениях PaaS, по сравнению с IaaS, менее сложна. Разработчик по-прежнему должен выполнять проверку подлинности и авторизацию для конкретного приложения, а также осуществлять доступ к внешним системам передачи данных. Однако CSP отвечает за защиту контейнерных экземпляров, операционных систем, временных файловых систем и некоторых сетевых элементов управления.

### SaaS

Модель "Программное обеспечение как услуга" представляет собой практически законченный продукт, в котором конечному пользователю остается только настроить мелкие детали в соответствии со своими потребностями. Пользователь, как правило, контролирует:

- Конфигурирование, администрирование и/или код в рамках продукта
- Доступ некоторых пользователей, например, назначение администраторов
- Высокоуровневые подключения к другим продуктам с помощью разрешений или интеграций

Весь технологический стек контролируется поставщиком (облачным сервисом или другой компанией-разработчиком программного обеспечения), и разработчик может вносить лишь относительно небольшие изменения в соответствии с индивидуальными потребностями. Это ограничивает затраты и техническое обслуживание, и проблемы, как правило, могут быть решены с помощью службы поддержки клиентов поставщика, в отличие от необходимости в технических знаниях для устранения неполадок во всем технологическом стеке.

|                   Плюсы                    |                Минусы               |
|:------------------------------------------:|:-----------------------------------:|
| Низкие затраты на техническое обслуживание | Ограничена ограничениями поставщика |
|                  Недорогая                 |         Минимальный контроль        |
|   Поддержка клиентов/устранение неполадок  |   Минимальное понимание/недосмотр   |

Безопасность с помощью SaaS является одновременно и самой простой, и самой сложной из-за отсутствия контроля, о котором говорилось выше. Разработчику придется управлять лишь небольшим набором функций безопасности, таких как некоторые средства контроля доступа, отношения доверия к данным и совместного использования при интеграции и любые последствия для безопасности, связанные с настройками. Все остальные уровни безопасности контролируются поставщиком. Это означает, что разработчик не будет иметь возможности вносить какие-либо исправления в систему безопасности, и, следовательно, они могут быть выполнены несвоевременно или с недостаточным уровнем безопасности для конечного пользователя (в зависимости от потребностей безопасности). Однако такие исправления не потребуют участия конечного пользователя и ресурсов, что упрощает их с точки зрения затрат и нагрузки на обслуживание.

*Примечание: При поиске SaaS-решений подумайте о том, чтобы запросить документы об аттестации компании и подтверждение соответствия стандартам, таким как [ISO 27001](https://www.iso.org/standard/27001). Ниже приведены ссылки на сайты всех основных поставщиков услуг по сертификации для получения дополнительной информации.*

- [GCP](https://cloud.google.com/security/compliance/offerings)
- [AWS](https://aws.amazon.com/compliance/programs/)
- [Azure](https://servicetrust.microsoft.com/ViewPage/HomePageVNext)

### Самоуправляемая оснастка

Другой способ более обобщенно описать эту модель совместной ответственности - классифицировать облачные инструменты по спектру "управления". Полностью управляемые сервисы оставляют конечному разработчику очень мало работы, помимо некоторых функций программирования или администрирования (SaaS), в то время как автономные системы требуют гораздо больших затрат на обслуживание (IaaS).

AWS представляет собой отличный пример такой разницы в управлении, определяя, где некоторые из их различных продуктов относятся к разным сегментам спектра.

![Shared Responsibility Model](../assets/Secure_Cloud_Architecture_Shared_Responsibility_Model.png)

*Примечание: Трудно точно указать, какие предложения считаются услугами определенного типа (например, IaaS или PaaS). Разработчикам следует стремиться понять модель, применимую к конкретному инструменту, который они используют.*

#### Стратегия обновления самоуправляемых сервисов

Self-managed tooling will require additional overhead by developers and support engineers. Depending on the tool, basic version updates, upgrades to images like [AMIs](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html) or [Compute Images](https://cloud.google.com/compute/docs/images), or other operating system level maintence will be required. Use automation to regularly update minor versions or [images](https://docs.aws.amazon.com/systems-manager/latest/userguide/automation-tutorial-update-patch-golden-ami.html), and schedule time in development cycles for refreshing stale resources.

#### Избегайте пробелов в безопасности управляемых сервисов

Управляемые сервисы будут обеспечивать определенный уровень безопасности, например, обновление и защиту базового оборудования, на котором выполняется код приложения. Однако команда разработчиков по-прежнему отвечает за многие аспекты безопасности системы. Убедитесь, что разработчики понимают, за какую безопасность они будут отвечать в зависимости от выбора инструментов. Скорее всего, разработчик частично или полностью будет нести ответственность за следующее:

- Аутентификация и авторизация
- Ведение журнала и мониторинг
- Защита кода ([OWASP Top 10](https://owasp.org/www-project-top-ten/))
- Внесение исправлений в сторонние библиотеки

Ознакомьтесь с документацией, предоставленной поставщиком облачных услуг, чтобы понять, за какие аспекты безопасности отвечает каждая сторона в зависимости от выбранного сервиса. Например, в случае бессерверных функций:

- [AWS Lambda](https://docs.aws.amazon.com/lambda/latest/dg/lambda-security.html)
- [GCP Cloud Functions](https://cloud.google.com/functions/docs/securing)
- [Azure Functions](https://learn.microsoft.com/en-us/azure/architecture/serverless-quest/functions-app-security)

## Ссылки на литературу

- [Secure Product Design](https://cheatsheetseries.owasp.org/cheatsheets/Secure_Product_Design_Cheat_Sheet.html)
- [CISA Security Technical Reference Architecture](https://www.cisa.gov/sites/default/files/publications/Cloud%20Security%20Technical%20Reference%20Architecture.pdf)
