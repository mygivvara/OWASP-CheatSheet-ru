# Шпаргалка по защите конфиденциальности пользователей

## Вступление

В этой шпаргалке OWASP представлены методы смягчения последствий, которые веб-разработчики могут использовать для защиты своих пользователей от широкого спектра потенциальных угроз и агрессивных действий, которые могут нарушить их конфиденциальность и анонимность. Эта шпаргалка посвящена угрозам конфиденциальности и анонимности, с которыми пользователи могут столкнуться при использовании онлайн-сервисов, особенно в таких контекстах, как социальные сети и коммуникационные платформы.

## Методические рекомендации

### Надежная криптография

Любая онлайн-платформа, которая обрабатывает идентификационные данные пользователей, личную информацию или коммуникации, должна быть защищена с использованием надежной криптографии. Сообщения пользователей должны быть зашифрованы при передаче и хранении. Пользовательские секреты, такие как пароли, также должны быть защищены с помощью надежных алгоритмов хэширования, устойчивых к коллизиям, с увеличивающимися рабочими факторами, чтобы значительно снизить риски раскрытия учетных данных, а также обеспечить надлежащий контроль целостности.

Для защиты передаваемых данных разработчики должны использовать и соблюдать рекомендации TLS/SSL, такие как проверенные сертификаты, надлежащим образом защищенные закрытые ключи, использование только надежных шифров, информативные и четкие предупреждения для пользователей, а также достаточную длину ключей. Личные данные должны быть зашифрованы в хранилище с использованием ключей достаточной длины и при соблюдении строгих условий доступа, как технических, так и процедурных. Учетные данные пользователя должны быть хэшированы независимо от того, зашифрованы они в хранилище или нет.

Для получения подробных руководств по надежной криптографии и рекомендациям ознакомьтесь со следующими ссылками на OWASP:

1. [Cryptographic Storage Cheat Sheet](Cryptographic_Storage_Cheat_Sheet.md).
2. [Authentication Cheat Sheet](Authentication_Cheat_Sheet.md).
3. [Transport Layer Security Cheat Sheet](Transport_Layer_Security_Cheat_Sheet.md).
4. [Guide to Cryptography](https://wiki.owasp.org/index.php/Guide_to_Cryptography).
5. [Testing for TLS/SSL](https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/01-Testing_for_Weak_SSL_TLS_Ciphers_Insufficient_Transport_Layer_Protection.html).

### Поддержка HTTP Strict Transport Security

HTTP Strict Transport Security (HSTS) - это HTTP-заголовок, устанавливаемый сервером, указывающий агенту пользователя, что принимаются только безопасные (HTTPS) соединения, побуждающий агента пользователя изменить все небезопасные HTTP-ссылки на HTTPS и заставляющий совместимый пользовательский агент выполнять отказоустойчивую работу, отказывая в любом TLS/SSL-соединении этому пользователь не доверяет.

HSTS имеет среднюю поддержку в популярных пользовательских агентах, таких как Mozilla Firefox и Google Chrome. Тем не менее, он остается очень полезным для пользователей, которые постоянно опасаются шпионажа и атак "Человек посередине".

Если нецелесообразно навязывать HATS всем пользователям, веб-разработчики должны, по крайней мере, предоставить пользователям возможность включить его, если они хотят им воспользоваться.

Для получения более подробной информации о HSTS, пожалуйста, посетите:

1. [HTTP Strict Transport Security in Wikipedia](https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security).
2. [IETF for HSTS RFC](https://tools.ietf.org/html/rfc6797).
3. [OWASP Appsec Tutorial Series - Episode 4: Strict Transport Security](http://www.youtube.com/watch?v=zEV3HOuM_Vw).

### Закрепление цифрового сертификата

Закрепление сертификата - это практика жесткого кодирования или хранения предопределенного набора информации (обычно хэшей) для цифровых сертификатов/открытых ключей в пользовательском агенте (будь то веб-браузер, мобильное приложение или плагин для браузера) таким образом, что для безопасного обмена данными используются только предопределенные сертификаты/открытые ключи, а все остальные не работают, даже если пользователь доверял (неявно или явно) другим сертификатам/открытым ключам.

Некоторые преимущества закрепления заключаются в следующем:

- В случае компрометации ЦС, при которой скомпрометированный ЦС, которому доверяет пользователь, может выдавать сертификаты для любого домена, позволяя злоумышленникам подслушивать пользователей.
- В средах, где пользователи вынуждены соглашаться с потенциально вредоносным корневым ЦС, таких как корпоративные среды или национальные схемы PKI.
- В приложениях, где целевая аудитория может не понимать предупреждений о сертификатах и, скорее всего, просто разрешит использование любого недействительного сертификата.

Для получения подробной информации о закреплении сертификата, пожалуйста, обратитесь к следующему:

1. [OWASP Certificate Pinning Cheat Sheet](Pinning_Cheat_Sheet.md).
2. [Public Key Pinning Extension for HTTP RFC](https://tools.ietf.org/html/rfc7469).
3. [Securing the SSL channel against man-in-the-middle attacks: Future technologies - HTTP Strict Transport Security and Pinning of Certs, by Tobias Gondrom](https://owasp.org/www-pdf-archive/OWASP_defending-MITMA_APAC2012.pdf).

### Режимы паники

Режим паники - это режим, в который могут обращаться пользователи, которым угрожает опасность, когда они подвергаются прямой угрозе раскрыть учетные данные учетной записи.

Предоставление пользователям возможности создавать режим паники может помочь им справиться с этими угрозами, особенно в неспокойных регионах по всему миру. К сожалению, многие пользователи по всему миру подвержены типам угроз, о которых большинство веб-разработчиков не знают или не принимают во внимание.

Примерами аварийных режимов являются режимы, в которых пользователи, попавшие в беду, могут удалять свои данные в случае угрозы, входить в поддельные почтовые ящики / учетные записи / системы или запускать триггеры для резервного копирования / загрузки / скрытия конфиденциальных данных.

Подходящий для реализации аварийный режим зависит от типа приложения. Программное обеспечение для шифрования диска, такое как VeraCrypt, может реализовать режим паники, который запускает поддельный системный раздел, если пользователь ввел свой неверный пароль.

Поставщики услуг электронной почты могут внедрить режим паники, который скрывает предопределенные конфиденциальные электронные письма или контакты, позволяя читать только невинные сообщения электронной почты, как правило, в соответствии с указаниями пользователя, и не допуская, чтобы режим паники распространялся на реальную учетную запись.

Важное замечание о режимах паники заключается в том, что их не должно быть легко обнаружить, если вообще возможно. Противник, находящийся в режиме паники жертвы, не должен иметь никакого способа или как можно меньше возможностей узнать правду. Это означает, что после перехода в режим паники необходимо разрешить выполнение большинства обычных операций, не требующих особого внимания (например, отправка или получение электронной почты), и что дополнительные режимы паники можно создавать из исходного режима паники (если злоумышленник пытался создать режим паники на основе паники жертвы режиме и потерпел неудачу, противник понял бы, что он уже находится в состоянии паники, и мог бы попытаться причинить вред жертве).

Другим решением было бы запретить создание режима паники из учетной записи пользователя, что немного усложнило бы его подделку злоумышленниками. Например, он может быть создан только вне зоны доступа, и у злоумышленников не должно быть возможности узнать, что режим паники уже существует для этой конкретной учетной записи.

Внедрение режима паники всегда должно быть направлено на то, чтобы сбить с толку злоумышленников и помешать им получить доступ к фактическим учетным записям/конфиденциальным данным жертвы, а также предотвратить обнаружение любых существующих режимов паники для конкретной учетной записи.

Для получения более подробной информации о скрытом режиме операционной системы VeraCrypt, пожалуйста, обратитесь к:

- [VeraCrypt Hidden Operating System](https://www.veracrypt.fr/en/Hidden%20Operating%20System.html).

### Аннулирование удаленного сеанса

В случае утери, кражи или конфискации пользовательского оборудования или при подозрении на кражу файлов cookie пользователям может быть очень полезно иметь возможность просматривать свои текущие онлайн-сеансы и отключать / аннулировать любые подозрительные длительные сеансы, особенно те, которые относятся к украденным или конфискованным устройствам. Удаленное аннулирование сеанса также может помочь, если пользователь подозревает, что данные его сеанса были украдены в результате атаки "Человек посередине".

Для получения более подробной информации об управлении сеансом, пожалуйста, обратитесь к:

- [OWASP Session Management Cheat Sheet](Session_Management_Cheat_Sheet.md).

### Разрешать подключения из анонимных сетей

Сети анонимности, такие как проект Tor, предоставляют пользователям в неспокойных регионах по всему миру прекрасную возможность избежать слежки, получить доступ к информации или преодолеть цензурные барьеры. Чаще всего активисты в проблемных регионах используют такие сети, чтобы сообщать о несправедливости или отправлять неподцензурную информацию остальному миру, особенно через такие средства массовой информации, как социальные сети, веб-сайты для потоковой передачи МЕДИА и поставщики электронной почты.

Веб-разработчики и сетевые администраторы должны использовать все возможности, чтобы пользователи могли получать доступ к сервисам из-за таких сетей, и любая политика, направленная против таких сетей анонимности, должна быть тщательно пересмотрена с точки зрения воздействия на людей по всему миру.

Если возможно, разработчикам приложений следует попытаться интегрировать свои приложения с этими сетями анонимности или обеспечить их простое взаимодействие с ними, например, с помощью поддержки SOCKS-прокси или библиотек интеграции (например, OnionKit для Android).

Для получения дополнительной информации о сетях анонимности и средствах защиты пользователей, которые они предоставляют, пожалуйста, обратитесь к:

1. [The Tor Project](https://www.torproject.org).
2. [I2P Network](http://www.i2p2.de).
3. [OnionKit: Boost Network Security and Encryption in your Android Apps](https://github.com/guardianproject/OnionKit).

### Предотвращение утечки IP-адреса

Предотвращение утечки IP-адресов пользователей имеет большое значение, когда речь идет о защите пользователей. Любое приложение, в котором размещается внешний контент третьих лиц, такой как аватары, подписи или вложенные фотографии, должно учитывать преимущества, которые дает возможность пользователям блокировать загрузку стороннего контента на странице приложения.

Если бы было возможно встроить сторонние изображения из внешнего домена, например, в ленту или временную шкалу пользователя, злоумышленник мог бы использовать это, чтобы узнать реальный IP-адрес жертвы, разместив его в своем домене, и отслеживать HTTP-запросы для этого изображения.

Многим веб-приложениям для работы требуется пользовательский контент, и это вполне приемлемо в качестве бизнес-процесса; однако веб-разработчикам рекомендуется рассмотреть возможность предоставления пользователям возможности блокировать внешний контент в качестве меры предосторожности. Это относится в основном к социальным сетям и форумам, но также может быть применимо к электронной почте в Интернете, где изображения могут быть встроены в электронные письма в формате HTML.

Аналогичная проблема существует в электронных письмах в формате HTML, содержащих изображения сторонних производителей, однако большинство почтовых клиентов и провайдеров по умолчанию блокируют загрузку стороннего контента, обеспечивая пользователям лучшую защиту конфиденциальности и анонимности.

### Честность и прозрачность

Если веб-приложение не может обеспечить достаточную юридическую или политическую защиту пользователя, или если веб-приложение не может предотвратить неправильное использование или раскрытие конфиденциальной информации, такой как логи, пользователям должна быть сообщена правда в ясной и понятной форме, чтобы пользователи могли сделать осознанный выбор относительно того, следует ли им это делать. воспользуйтесь именно этой услугой.

Если это не нарушает закон, сообщите пользователям, запрашивается ли их информация для удаления или расследования внешними организациями.

Честность во многом способствует развитию культуры доверия между веб-приложением и его пользователями, и это позволяет многим пользователям по всему миру тщательно взвешивать свои варианты, предотвращая причинение вреда пользователям в различных регионах мира.

Более подробную информацию о безопасном ведении журнала можно найти на сайте:

- [OWASP Logging Cheat Sheet](Logging_Cheat_Sheet.md)
